<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="Stay Hungry. Stay Foolish.">
<meta property="og:type" content="website">
<meta property="og:title" content="ä¸è¦æ€¥ï¼Œä¸è¦æ€•">
<meta property="og:url" content="http://yoursite.com/child/page/2/index.html">
<meta property="og:site_name" content="ä¸è¦æ€¥ï¼Œä¸è¦æ€•">
<meta property="og:description" content="Stay Hungry. Stay Foolish.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ä¸è¦æ€¥ï¼Œä¸è¦æ€•">
<meta name="twitter:description" content="Stay Hungry. Stay Foolish.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/child/page/2/"/>





  <title> ä¸è¦æ€¥ï¼Œä¸è¦æ€• </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">ä¸è¦æ€¥ï¼Œä¸è¦æ€•</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Life needs curiosity and passion.</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/child/2016/12/21/åŸºäºsocketçš„â€œæŠ½å¥–â€/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="hapii">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://tva1.sinaimg.cn/crop.0.14.750.750.180/005PluWajw8fahgdnankoj30ku0lnjsd.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸è¦æ€¥ï¼Œä¸è¦æ€•">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸è¦æ€¥ï¼Œä¸è¦æ€•" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/21/åŸºäºsocketçš„â€œæŠ½å¥–â€/" itemprop="url">
                  åŸºäºsocketçš„â€œæŠ½å¥–â€
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-21T10:22:01+08:00">
                2016-12-21
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/12/21/åŸºäºsocketçš„â€œæŠ½å¥–â€/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/21/åŸºäºsocketçš„â€œæŠ½å¥–â€/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/12/21/åŸºäºsocketçš„â€œæŠ½å¥–â€/" class="leancloud_visitors" data-flag-title="åŸºäºsocketçš„â€œæŠ½å¥–â€">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•° </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>socketï¼ˆå¥—æ¥å­—ï¼‰æ˜¯é€šä¿¡çš„åŸºçŸ³ï¼Œæ˜¯æ”¯æŒTCP/IPåè®®çš„ç½‘ç»œé€šä¿¡çš„åŸºæœ¬æ“ä½œå•å…ƒï¼ŒåŒ…å«è¿›è¡Œç½‘ç»œé€šä¿¡å¿…é¡»çš„äº”ç§ä¿¡æ¯ï¼šè¿æ¥ä½¿ç”¨çš„åè®®ï¼Œæœ¬åœ°ä¸»æœºçš„IPåœ°å€ï¼Œæœ¬åœ°è¿›ç¨‹çš„åè®®ç«¯å£ï¼Œè¿œåœ°ä¸»æœºçš„IPåœ°å€ï¼Œè¿œåœ°è¿›ç¨‹çš„åè®®ç«¯å£ã€‚</p>
<p>å¤šä¸ªTCPè¿æ¥æˆ–å¤šä¸ªåº”ç”¨ç¨‹åºè¿›ç¨‹å¯èƒ½éœ€è¦é€šè¿‡åŒä¸€ä¸ªTCPåè®®ç«¯å£ä¼ è¾“æ•°æ®ã€‚ä¸ºäº†åŒºåˆ«ä¸åŒçš„åº”ç”¨ç¨‹åºè¿›ç¨‹å’Œè¿æ¥ï¼Œè®¡ç®—æœºæ“ä½œç³»ç»Ÿä¸ºåº”ç”¨ç¨‹åºä¸TCPï¼IPåè®®äº¤äº’æä¾›äº†å¥—æ¥å­—(Socket)æ¥å£ã€‚åº”ç”¨å±‚å¯ä»¥å’Œä¼ è¾“å±‚é€šè¿‡Socketæ¥å£ï¼ŒåŒºåˆ†æ¥è‡ªä¸åŒåº”ç”¨ç¨‹åºè¿›ç¨‹æˆ–ç½‘ç»œè¿æ¥çš„é€šä¿¡ï¼Œå®ç°æ•°æ®ä¼ è¾“çš„å¹¶å‘æœåŠ¡ã€‚</p>
<p>å»ºç«‹Socketè¿æ¥è‡³å°‘éœ€è¦ä¸€å¯¹å¥—æ¥å­—ï¼Œå…¶ä¸­ä¸€ä¸ªè¿è¡Œäºå®¢æˆ·ç«¯ï¼Œç§°ä¸ºClientSocketï¼Œå¦ä¸€ä¸ªè¿è¡ŒäºæœåŠ¡å™¨ç«¯ï¼Œç§°ä¸ºServerSocketã€‚å¥—æ¥å­—ä¹‹é—´çš„è¿æ¥è¿‡ç¨‹åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼šæœåŠ¡å™¨ç›‘å¬ï¼Œå®¢æˆ·ç«¯è¯·æ±‚ï¼Œè¿æ¥ç¡®è®¤ã€‚</p>
<p>Socketå¯ä»¥æ”¯æŒä¸åŒçš„ä¼ è¾“å±‚åè®®ï¼ˆTCPæˆ–UDPï¼‰ï¼Œå½“ä½¿ç”¨TCPåè®®è¿›è¡Œè¿æ¥æ—¶ï¼Œè¯¥Socketè¿æ¥å°±æ˜¯ä¸€ä¸ªTCPè¿æ¥,UDPè¿æ¥åŒç†ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1170656-6b9392fad31b711d.png?imageMogr2/auto-orient/strip%7CimageView2/2" alt="åŸç†å›¾"></p>
<h2 id="AsyncUdpSocket"><a href="#AsyncUdpSocket" class="headerlink" title="AsyncUdpSocket:"></a>AsyncUdpSocket:</h2><p>è¿™é‡Œç”¨åˆ°äº†ä¸€ä¸ªä¸‰æ–¹AsyncUdpSocket,<a href="http://code.google.com/p/cocoaasyncsocket/" target="_blank" rel="external">åŸæ¥çš„ä¸‹è½½åœ°å€</a>ä¸è¿‡ç°åœ¨ä¸èƒ½ç”¨äº†,githubæœ‰ç±»ä¼¼çš„ï¼Œåº”è¯¥ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ã€‚è¿™å¥—æŠ½å¥–æ˜¯socketçš„åŠå…¶ç®€å•çš„åº”ç”¨ï¼Œå†™ä¸¤å¥—ä»£ç åˆ†åˆ«ç»™æ“ä½œç«¯å’Œç°å®ç«¯ã€‚</p>
<p><img src="http://i1.piimg.com/567571/687e886eb093e4d7.gif" alt="å…ˆæ¥å¼ å›¾"><br>æŠ½å¥–æ—¶ç”¨çš„æ˜¯éšæœºæ•°å¯¹20å–ä½™ï¼Œè€Œæœ€åçš„â€œç°åœ¨â€å°±æ˜¯é€šè¿‡socketå‘é€åˆ°ç°å®ç«¯çš„ã€‚</p>
<h2 id="æ˜¾ç¤ºç«¯"><a href="#æ˜¾ç¤ºç«¯" class="headerlink" title="æ˜¾ç¤ºç«¯:"></a>æ˜¾ç¤ºç«¯:</h2><p>ä»£ç å¾ˆç®€å•ï¼Œè¿™é‡Œæˆ‘å°±ç›´æ¥ç²˜äº†:</p>
<pre><code>#import &quot;ViewController.h&quot;
#import &quot;AsyncUdpSocket.h&quot;
#import &lt;AVFoundation/AVFoundation.h&gt;

#define RandomColor [UIColor colorWithRed:arc4random_uniform(256)/255.0 green:arc4random_uniform(256)/255.0 blue:arc4random_uniform(256)/255.0 alpha:1.0]//éšæœºè‰²

#define screenWidth [UIScreen mainScreen].bounds.size.width
#define screenHeight [UIScreen mainScreen].bounds.size.height


@interface ViewController ()&lt;AsyncUdpSocketDelegate&gt;{
AsyncUdpSocket *_socket;
NSTimer *_timer;
NSString *_lastStr;
UIButton *startBut;


}

@property (nonatomic,strong)AVPlayer *player;
@property (nonatomic,strong)UILabel *label;

@end

@implementation ViewController

//æ‡’åŠ è½½æ’­æ”¾å™¨
- (AVPlayer *)player{
if (_player == nil) {
    // 1.è·å–URL(è¿œç¨‹/æœ¬åœ°)
     NSURL *url = [[NSBundle mainBundle] URLForResource:@&quot;M11-01-05-57.mp3&quot; withExtension:nil];
    //NSURL *url = [NSURL URLWithString:@&quot;http://v1.mukewang.com/a45016f4-08d6-4277-abe6-bcfd5244c201/L.mp4&quot;];

    // 2.åˆ›å»ºAVPlayerItem
    AVPlayerItem *item = [AVPlayerItem playerItemWithURL:url];

    // 3.åˆ›å»ºAVPlayer
    _player = [AVPlayer playerWithPlayerItem:item];

    // 4.æ·»åŠ AVPlayerLayer
    AVPlayerLayer *layer = [AVPlayerLayer playerLayerWithPlayer:self.player];
    layer.frame = CGRectMake(0, 0, self.view.bounds.size.width, self.view.bounds.size.width * 9 / 16);
    [self.view.layer addSublayer:layer];
}
return _player;}

//æ­å»ºé¡µé¢    
- (void)viewDidLoad {
[super viewDidLoad];

_label = [[UILabel alloc] initWithFrame:CGRectMake(screenWidth/2-150, 100, 300, 300)];
_label.backgroundColor = [UIColor orangeColor];
_label.font = [UIFont systemFontOfSize:33.0f weight:21];
_label.textAlignment = NSTextAlignmentCenter;
[self.view addSubview:self.label];

startBut = [[UIButton alloc] initWithFrame:CGRectMake(screenWidth/2-50, screenHeight-200, 100, 50)];
[startBut setBackgroundColor:[UIColor redColor]];
[startBut setTitle:@&quot;å¼€å§‹æŠ½å¥–&quot; forState:UIControlStateNormal];
[startBut addTarget:self action:@selector(LetUsBegin) forControlEvents:UIControlEventTouchUpInside];
[self.view addSubview:startBut];



_socket = [[AsyncUdpSocket alloc]initIPv4];
_socket.delegate = self;
//ip å’Œ ç«¯å£å·//è¿™ä¸ªé‡ç”µè„‘çš„ç½‘ç»œçœ‹ï¼Œå¿…éœ€è¦ä¸€è‡´
[_socket bindToAddress:@&quot;10.10.5.32&quot; port:9444 error:nil];

//ä¿æŒè¿æ¥
[_socket receiveWithTimeout:-1 tag:0];
</code></pre><p>}</p>
<p>//ç‚¹å‡»äº†å¼€å§‹æŠ½å¥–æŒ‰é’®</p>
<pre><code>- (void)LetUsBegin{
 startBut.hidden = YES;
[self.player play];
_timer = [NSTimer scheduledTimerWithTimeInterval:0.4 target:self selector:@selector(ChangeLabelText) userInfo:nil repeats:YES];

[[NSRunLoop currentRunLoop] addTimer:_timer forMode:NSDefaultRunLoopMode];

dispatch_after(dispatch_time(DISPATCH_TIME_NOW,(int64_t)(9* NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
    [self stopTimer];
});
</code></pre><p>}</p>
<p>10ç§’è¿‡ååœæ­¢</p>
<pre><code>- (void)stopTimer{
[_timer invalidate];
_timer = nil;
if (_lastStr) {
     _label.text  = _lastStr;
}else{
    _label.text = [NSString stringWithFormat:@&quot;%i&quot;,arc4random()%30];
}
   startBut.hidden = NO;
_label.backgroundColor = RandomColor;
_lastStr = nil;
self.player = nil;
}
</code></pre><p>å®šæ—¶å™¨æ–¹æ³•,</p>
<pre><code>- (void)ChangeLabelText{
_label.text = [NSString stringWithFormat:@&quot;%i&quot;,arc4random()%20];
_label.backgroundColor = RandomColor;
</code></pre><p>}</p>
<p>socketä»£ç†æ–¹æ³•</p>
<pre><code>-(BOOL)onUdpSocket:(AsyncUdpSocket *)sock didReceiveData:(NSData *)data withTag:(long)tag fromHost:(NSString *)host port:(UInt16)port{

_lastStr =  [[NSString alloc] initWithData:data  encoding:NSUTF8StringEncoding];
  //ä¿æŒè¿æ¥
    [_socket receiveWithTimeout:-1 tag:0];
 return YES;
</code></pre><p>}</p>
<h2 id="æ§åˆ¶ç«¯"><a href="#æ§åˆ¶ç«¯" class="headerlink" title="æ§åˆ¶ç«¯:"></a>æ§åˆ¶ç«¯:</h2><p><img src="http://i1.piimg.com/567571/c39e41ea7ca885d2.jpg" alt="æ§åˆ¶ç«¯çš„æ ·å¼"><br>ä¸‹é¢æ”¾ä»£ç :</p>
<pre><code>#import &quot;ViewController.h&quot;
#import &quot;AsyncUdpSocket.h&quot;
#include &lt;ifaddrs.h&gt;
#include &lt;arpa/inet.h&gt;

@interface ViewController (){
  AsyncUdpSocket *_socket;
NSString *_ipAddress;
}

@property (nonatomic,strong)UITextField *tf;

@end

@implementation ViewController

- (void)viewDidLoad {
[super viewDidLoad];

//è¾“å…¥æ¡†
_tf = [[UITextField alloc] initWithFrame:CGRectMake(20, 100, 200, 50)];
_tf.backgroundColor = [UIColor grayColor];
[self.view addSubview:_tf];

//è·å–ipåœ°å€
_ipAddress = [self deviceIPAdress];
NSLog(@&quot;%@&quot;,_ipAddress);

UIButton *but = [[UIButton alloc] initWithFrame:CGRectMake(200, 200, 80, 30)];
[but setBackgroundColor:[UIColor redColor]];
[but setTitle:@&quot;å‘é€&quot; forState:UIControlStateNormal];
[but addTarget:self action:@selector(sendTheNumber) forControlEvents:UIControlEventTouchUpInside];
[self.view addSubview:but];
}
</code></pre><p>//åˆå§‹åŒ–socketå’Œå‘é€ip</p>
<pre><code>- (void)sendTheNumber{
_socket = [[AsyncUdpSocket alloc]initIPv4];
_socket.delegate = self;
//ip å’Œ ç«¯å£å·
[_socket bindToAddress:_ipAddress port:9444 error:nil];

//[_socket sendData:data toAddress:@&quot;192.168.1.160&quot; withTimeout:-1 tag:0];

NSData* data = [_tf.text dataUsingEncoding:NSUTF8StringEncoding];

[_socket sendData:data toHost:@&quot;10.10.5.38&quot; port:9444 withTimeout:-1 tag:0];

_tf.text = @&quot;&quot;;
//ä¿æŒè¿æ¥
[_socket receiveWithTimeout:-1 tag:0];
}

- (BOOL)onUdpSocket:(AsyncUdpSocket *)sock didReceiveData:(NSData *)data withTag:(long)tag fromHost:(NSString *)host port:(UInt16)port{

return YES;
</code></pre><p>}</p>
<pre><code>//wifiä¸‹è·å–æ‰‹æœºipçš„æ–¹æ³•

- (NSString *)deviceIPAdress {
NSString *address = @&quot;an error occurred when obtaining ip address&quot;;
struct ifaddrs *interfaces = NULL;
struct ifaddrs *temp_addr = NULL;
int success = 0;

success = getifaddrs(&amp;interfaces);

if (success == 0) { // 0 è¡¨ç¤ºè·å–æˆåŠŸ

    temp_addr = interfaces;
    while (temp_addr != NULL) {
        if( temp_addr-&gt;ifa_addr-&gt;sa_family == AF_INET) {
            // Check if interface is en0 which is the wifi connection on the iPhone
            if ([[NSString stringWithUTF8String:temp_addr-&gt;ifa_name] isEqualToString:@&quot;en0&quot;]) {
                // Get NSString from C String
                address = [NSString stringWithUTF8String:inet_ntoa(((struct sockaddr_in *)temp_addr-&gt;ifa_addr)-&gt;sin_addr)];
            }
        }

        temp_addr = temp_addr-&gt;ifa_next;
    }
}

freeifaddrs(interfaces);

NSLog(@&quot;æ‰‹æœºçš„IPæ˜¯ï¼š%@&quot;, address);
return address;
</code></pre><p>}</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">


      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/child/2016/12/01/webViewå’ŒtableViewçš„æ··æ’/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="hapii">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://tva1.sinaimg.cn/crop.0.14.750.750.180/005PluWajw8fahgdnankoj30ku0lnjsd.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸è¦æ€¥ï¼Œä¸è¦æ€•">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸è¦æ€¥ï¼Œä¸è¦æ€•" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/01/webViewå’ŒtableViewçš„æ··æ’/" itemprop="url">
                  webViewå’ŒtableViewçš„æ··æ’
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-12-01T11:18:15+08:00">
                2016-12-01
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/12/01/webViewå’ŒtableViewçš„æ··æ’/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/01/webViewå’ŒtableViewçš„æ··æ’/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/12/01/webViewå’ŒtableViewçš„æ··æ’/" class="leancloud_visitors" data-flag-title="webViewå’ŒtableViewçš„æ··æ’">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•° </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ç±»ä¼¼äºè¿‘æ—¥å¤´æ¡çš„ä¸Šè¾¹æ˜¯webViewï¼Œä¸‹è¾¹æ˜¯æ¨èçš„tableViewæ•ˆæœ.<br><img src="http://p1.bpimg.com/567571/41d03799238bb66c.gif" alt="å…ˆçœ‹ä¸€ä¸‹æ•ˆæœå›¾"><br>é¦–å…ˆè¯´ä¸€ä¸‹tableViewå’ŒWebViewçš„åµŒå¥—æ–¹æ³•ï¼Œè¯•äº†å¥½å¤šç§ï¼Œæ„Ÿè§‰è¿™ä¸ªæ¯”è¾ƒå¥½    <a href="http://www.jianshu.com/p/4658d68cf280" target="_blank" rel="external">åŸæ–‡é“¾æ¥ï¼š</a></p>
<h2 id="ç‚¹å‡»cellåˆ·æ–°cell"><a href="#ç‚¹å‡»cellåˆ·æ–°cell" class="headerlink" title="ç‚¹å‡»cellåˆ·æ–°cell:"></a>ç‚¹å‡»cellåˆ·æ–°cell:</h2><p>ç‚¹å‡»cellåè¦æŸ¥çœ‹æ–°çš„å†…å®¹ï¼Œé¦–å…ˆåœ¨tableView didSelectRowAtIndexPathé‡Œå¯¹è¯·æ±‚ç½‘å€çš„å˜é‡é‡æ–°èµ‹å€¼,idå•¦ï¼Œurlä¹‹ç±»çš„ï¼Œç„¶åç§»é™¤è§†å›¾ä¸­æ‰€æœ‰çš„View</p>
<pre><code>for(UIView *view in [self.view subviews]){
       [view removeFromSuperview];
   }
</code></pre><p>è®°å¾—ç§»é™¤è§‚å¯Ÿè€…ï¼Œå› ä¸ºè¦è§‚å¯Ÿçš„å¯¹è±¡å·²ç»æ²¡äº†ã€‚</p>
<p>ç„¶åæŠŠæ­å»ºé¡µé¢è¯·æ±‚æ•°æ®çš„æ–¹æ³•é‡å†™ä¸€é</p>
<pre><code> [self createUI];
//[self createReturnBut];
[self loadDataisFresh:NO];//è¯·æ±‚æ•°æ®
//æ³¨å†Œ
[self registerNibTableViewCell];
//åŠ è½½æ•°æ®
[self requestByUrl:self.loadUrl];
</code></pre><p>è¿™é‡Œè¦è®°å¾—åœ¨æ³¨å†Œä¸€æ¬¡è§‚å¯Ÿè€…ï¼Œæˆ‘æŠŠä»–æ”¾åˆ°äº†createUIè¿™ä¸ªæ–¹æ³•é‡Œ</p>
<pre><code>[self.webView.scrollView addObserver:self forKeyPath:@&quot;contentSize&quot; options:NSKeyValueObservingOptionOld | NSKeyValueObservingOptionNew context:nil];
</code></pre><p>åˆ·æ–°tableView</p>
<pre><code>[self.tb reloadData];
</code></pre><p>å¯¹äº†ï¼Œåœ¨å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œè®°å½•webViewçš„é«˜åº¦ï¼Œç”¨äºç‚¹å‡»è·³åˆ°å¤´éƒ¨</p>
<pre><code>@property (nonatomic,assign)CGFloat webViewHeight;
</code></pre><p>åœ¨- (void)observeValueForKeyPath:æ–¹æ³•ä¸­ç»™ä»–èµ‹å€¼</p>
<pre><code> CGRect frame = self.webView.frame;
 frame.size.height = self.webView.scrollView.contentSize.height;
 //è¿™é‡Œè·å–webViewçš„é«˜åº¦
_webViewHeight = frame.size.height;
</code></pre><p>æœ€åå›åˆ°tableView didSelectRowAtIndexPath:ç‚¹å‡»æ–¹æ³•ä¸­,è·³åˆ°é¡¶éƒ¨,tableViewçš„é«˜åº¦å‡å»webViewçš„é«˜åº¦</p>
<pre><code>[self.tb setContentOffset:CGPointMake(0, -_webViewHeight) animated:YES];
</code></pre><p> è®©tableViewæ»šå›åˆ°æœ€é¡¶ç«¯ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">


      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/child/2016/11/25/iOSæç¤ºç‰ˆæœ¬æ›´æ–°/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="hapii">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://tva1.sinaimg.cn/crop.0.14.750.750.180/005PluWajw8fahgdnankoj30ku0lnjsd.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸è¦æ€¥ï¼Œä¸è¦æ€•">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸è¦æ€¥ï¼Œä¸è¦æ€•" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/25/iOSæç¤ºç‰ˆæœ¬æ›´æ–°/" itemprop="url">
                  iOSæç¤ºç‰ˆæœ¬æ›´æ–°
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-25T12:19:02+08:00">
                2016-11-25
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/11/25/iOSæç¤ºç‰ˆæœ¬æ›´æ–°/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/25/iOSæç¤ºç‰ˆæœ¬æ›´æ–°/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/11/25/iOSæç¤ºç‰ˆæœ¬æ›´æ–°/" class="leancloud_visitors" data-flag-title="iOSæç¤ºç‰ˆæœ¬æ›´æ–°">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•° </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ä¸€ï¼šåœ¨æŸä¸ªæœåŠ¡å™¨ä¸Šå­˜å‚¨æœ€æ–°å‘å¸ƒçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œéœ€è¦çš„æ—¶å€™å‘è¯¥æœåŠ¡å™¨æŸ¥è¯¢ï¼›<br>äºŒï¼šåœ¨éœ€è¦çš„æ—¶å€™å‘ appstore æŸ¥è¯¢</p>
<p>æ–¹æ³•ä¸€å°±ä¸å¤šè¯´äº†ï¼Œä¸ªäººæ„Ÿè§‰è¿˜æ˜¯æ³•äºŒå¥½ä¸€äº›ï¼Œæ›´æ–°åŠæ—¶ï¼Œè‡ªå·±å°±æå®šäº†ï¼Œä¸ç”¨å’Œåå°äº¤æµã€‚</p>
<h2 id="è¯·æ±‚"><a href="#è¯·æ±‚" class="headerlink" title="è¯·æ±‚:"></a>è¯·æ±‚:</h2><p>getè¯·æ±‚ è¿™ä¸ªåœ°å€<a href="http://itunes.apple.com/lookup?id=ä½ çš„appid" target="_blank" rel="external">http://itunes.apple.com/lookup?id=ä½ çš„appid</a><br>ä¹‹åæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªçš„jsonæ•°æ®ï¼Œé‡Œé¢åŒ…å«ç€æˆ‘ä»¬å¥½å¤šçš„appå„ç§ä¿¡æ¯ï¼Œè¿™é‡Œæˆ‘åˆ äº†å¥½å¤š.<br> {<br>    resultCount = 1;<br>    results =     (<br>                {<br>            advisories =             (<br>            );</p>
<pre><code>        features =             (
        );
        fileSizeBytes = 14362624;
        formattedPrice = Free;
        genreIds =             (
            6009,
            6002
        );
        genres =             (
            News,
            Utilities
        );

        trackName = &quot;\U9ed4\U897f\U5357\U624b\U673a\U53f0&quot;;
        trackViewUrl = &quot;https://itunes.apple.com/us/app/qian-xi-nan-shou-ji-tai/id786874960?mt=8&amp;uo=4&quot;;
        version = &quot;1.5.4&quot;;
        wrapperType = software;
    }
);
</code></pre><p>}</p>
<p>ç”¨å¦‚ä¸‹çš„æ–¹æ³•çš„åˆ°appçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå…ˆå¾—åˆ°resultsæ•°ç»„ï¼š</p>
<pre><code>NSArray *infoArray = [responseObject objectForKey:@&quot;results&quot;];
</code></pre><p>å–ç¬¬ä¸€ä¸ªå­—å…¸ï¼š</p>
<pre><code>NSDictionary *releaseInfo = [infoArray objectAtIndex:0];
</code></pre><p>å¾—åˆ°å½“å‰ç‰ˆæœ¬å·ä»¥åŠappçš„ä¸‹è½½åœ°å€ï¼š</p>
<pre><code>NSString *latestVersion = [releaseInfo objectForKey:@&quot;version&quot;];
NSString *trackViewUrl = [releaseInfo objectForKey:@&quot;trackViewUrl&quot;];
</code></pre><p>ä½†æ˜¯æ³¨æ„è¿™ä¸ªæ–¹æ³•ä¸è¦æ¯æ¬¡å»æ‰§è¡Œï¼Œæ²¡æœ‰å¿…è¦ï¼Œæœ€å¥½æ˜¯ä¸€å¤©çš„æŸä¸ªæ—¶é—´æ‰§è¡Œä¸€æ¬¡ï¼Œ</p>
<p>å¾—åˆ°ç‰ˆæœ¬å·ï¼Œ</p>
<pre><code>NSString* localVersion =  [[NSBundle mainBundle] infoDictionary][@&quot;CFBundleVersion&quot;];
</code></pre><h2 id="æ¯”è¾ƒappç‰ˆæœ¬å·"><a href="#æ¯”è¾ƒappç‰ˆæœ¬å·" class="headerlink" title="æ¯”è¾ƒappç‰ˆæœ¬å·:"></a>æ¯”è¾ƒappç‰ˆæœ¬å·:</h2><pre><code>if ([latestVersion compare:localVersion options:NSNumericSearch] == NSOrderedDescending) {
    NSLog(@&quot;%@ is bigger&quot;,latestVersion);
  //å¼¹å‡ºæç¤ºæ¡†ï¼Œæ˜¯å¦ä¸‹è½½
}else
{
    NSLog(@&quot;%@ is bigger&quot;,localVersion);
}
</code></pre><h2 id="è·³è½¬ä¸‹è½½"><a href="#è·³è½¬ä¸‹è½½" class="headerlink" title="è·³è½¬ä¸‹è½½:"></a>è·³è½¬ä¸‹è½½:</h2><p>å¦‚æœå¤§äºåˆ™å¼¹å‡ºæç¤ºæ¡†ï¼Œæç¤ºç”¨æˆ·æ˜¯å¦å‰å¾€ä¸‹è½½ï¼Œå‰å¾€ä¸‹è½½çš„è¯ï¼Œç”¨openURLç›´æ¥è·³è½¬åˆ°äº†appStoreä¸Šï¼ˆåŒæ ·ï¼Œç»™å¥½è¯„ç­‰ä¹Ÿæ˜¯é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼‰</p>
<pre><code>[[UIApplication sharedApplication] openURL:[NSURL URLWithString:trackViewUrl]];
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">


      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/child/2016/11/18/PHAsset/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="hapii">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://tva1.sinaimg.cn/crop.0.14.750.750.180/005PluWajw8fahgdnankoj30ku0lnjsd.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸è¦æ€¥ï¼Œä¸è¦æ€•">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸è¦æ€¥ï¼Œä¸è¦æ€•" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/18/PHAsset/" itemprop="url">
                  PhotoKit
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-18T11:05:28+08:00">
                2016-11-18
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/11/18/PHAsset/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/18/PHAsset/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/11/18/PHAsset/" class="leancloud_visitors" data-flag-title="PhotoKit">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•° </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ç”±äºé¡¹ç›®é‡æ„ï¼Œå°†å›¾ç‰‡é€‰æ‹©å™¨é‡<a href="https://github.com/chiunam/CTAssetsPickerController" target="_blank" rel="external">CTAssetsPickerController</a>æ¢æˆäº†<a href="https://github.com/banchichen/TZImagePickerController" target="_blank" rel="external">TZImagePickerController</a>ï¼Œä¸¤è€…éƒ½æ˜¯ä¼˜ç§€çš„å›¾ç‰‡é€‰æ‹©å™¨ï¼Œä½†æˆ‘ä¸ªäººæ›´å–œæ¬¢åè€…ï¼ˆå› ä¸ºæœ‰ä¸­åˆè¯´æ˜ï½ï½ï¼‰ã€‚</p>
<p>æ¢å®Œä¹‹åå‘ç°è§†é¢‘ä¸Šä¼ åŠŸèƒ½å‡ºé—®é¢˜äº†ï¼ŒåŸæ¥ä»¥å‰çš„ä¸Šä¼ æ–¹æ³•æ˜¯ç”¨ALAssetsLibraryä¸Šä¼ çš„ï¼Œä½†æ˜¯çœ‹TZImagePickerControllerå‘ç°8ä»¥åå°±ä½¿ç”¨çš„Photos Frameworkã€‚</p>
<pre><code>// If user picking a video, this handle will be called.
// If system version &gt; iOS8,asset is kind of PHAsset class, else is ALAsset class.
// å¦‚æœç”¨æˆ·é€‰æ‹©äº†ä¸€ä¸ªè§†é¢‘ï¼Œä¸‹é¢çš„handleä¼šè¢«æ‰§è¡Œ
// å¦‚æœç³»ç»Ÿç‰ˆæœ¬å¤§äºiOS8ï¼Œassetæ˜¯PHAssetç±»çš„å¯¹è±¡ï¼Œå¦åˆ™æ˜¯ALAssetç±»çš„å¯¹è±¡
@property (nonatomic, copy) void (^didFinishPickingVideoHandle)(UIImage *coverImage,id asset);
</code></pre><p>è¿™æ˜¯ä»¥å‰ä¸Šä¼ çš„ä¸¤ç§æ–¹æ³•ï¼Œ</p>
<pre><code>ALAsset *asset = [mediaDatas objectAtIndexSafe:0];
NBLog(@&quot;asset=%@, representation=%@, url=%@&quot;, asset, [asset defaultRepresentation], [asset defaultRepresentation].url);

 if (asset != nil) {

    if (/* DISABLES CODE */ (1)) {
        NSString *videoPath = [NSDocumentsPath stringByAppendingPathComponent:[NSString stringWithFormat:@&quot;%d.mov&quot;, 0]];    // è¿™é‡Œç›´æ¥å¼ºåˆ¶å†™ä¸€ä¸ªå³å¯ï¼Œä¹‹å‰è®¡åˆ’æ˜¯ç”¨i++æ¥åŒºåˆ†ä¸æ˜è§†é¢‘
        //å¯ä»¥çœ‹å‡ºæ¥ä½¿ç”¨fileURLWithPathåˆ›å»ºå‡ºæ¥çš„URLä¼šè‡ªåŠ¨åŠ ä¸Šåè®®å¤´
        NSURL *url = [NSURL fileURLWithPath:videoPath];
        NSError *theErro = nil;
        BOOL exportResult = [asset exportDataToURL:url error:&amp;theErro];
        NBLog(@&quot;exportResult=%@&quot;, exportResult?@&quot;YES&quot;:@&quot;NO&quot;);

        NSData *videoData = [NSData dataWithContentsOfURL:url];
        //      NSData *videoData = [NSData dataWithContentsOfFile:videoPath];
        //                                        [formData appendPartWithFormData:videoData name:@&quot;video1&quot;];
        //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æœåŠ¡å™¨å­˜ä½ ä¸Šä¼ è§†é¢‘çš„æ–‡ä»¶å¤¹åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä½ ä¸Šä¼ è§†é¢‘çš„åå­—ï¼Œéšä¾¿å†™ã€‚ç¬¬ä¸‰ä¸ªæ˜¯æ ¼å¼ã€‚
        [formData appendPartWithFileData:videoData name:@&quot;video1&quot; fileName:@&quot;video1.mov&quot; mimeType:@&quot;video/quicktime&quot;];

    }else {

        //ç¬¬ä¸€ç§è·å–NSDataçš„æ–¹å¼ï¼Œ ä¸Šä¼ åï¼Œ åå°ä»…è·å–åˆ°æ–‡æœ¬
        //ALAssetRepresentationè·å–æœ¬åœ°ç›¸å†Œ
        ALAssetRepresentation *rep = [asset defaultRepresentation];
        Byte *buffer = (Byte*)malloc(rep.size);
        NSUInteger buffered = [rep getBytes:buffer fromOffset:0.0 length:rep.size error:nil];
        NSData *videoData = [NSData dataWithBytesNoCopy:buffer length:buffered freeWhenDone:YES];
        //ä¼ åˆ°æœåŠ¡å™¨
        //[formData appendPartWithFormData:videoData name:@&quot;video1&quot;];
        [formData appendPartWithFileData:videoData name:@&quot;video1&quot; fileName:@&quot;video1&quot; mimeType:@&quot;video/quicktime&quot;];
     }

    NBLog(@&quot;method 2&quot;);
}
</code></pre><p>ç‚¹å¼€ALAssetsLibraryï¼Œå‘ç°äººæ€§åŒ–çš„ğŸæ—©å·²ä¸ºä½ å†™å¥½äº†æ–°æ–¹æ³•<br><img src="http://i1.piimg.com/567571/20f5db8f656beaeb.png" alt="ALAssetsLibraryçš„æ–¹æ³•"><br> æ–°æ–¹æ³•:</p>
<pre><code>PHAsset *asset = [mediaDatas objectAtIndexSafe:0];

 [[PHImageManager defaultManager] requestImageDataForAsset:asset options:nil resultHandler:^(NSData * _Nullable imageData, NSString * _Nullable dataUTI, UIImageOrientation orientation, NSDictionary * _Nullable info) {
                         [formData appendPartWithFileData:imageData name:@&quot;video1&quot; fileName:@&quot;video1&quot; mimeType:@&quot;video/quicktime&quot;];
                   }];
</code></pre><p>ç”±äºç°åœ¨é¡¹ç›®æœ€ä½8.0ï¼Œæ‰€ä»¥å°±ä¸åšALAssetsLibraryçš„æ–¹æ³•çš„äº†ã€‚<br>å¥½äº†ï¼Œä¸‹é¢è¯¥è¯´ä¸€è¯´PHAssetäº†ã€‚</p>
<hr>
<h2 id="PHAsset"><a href="#PHAsset" class="headerlink" title="PHAsset:"></a>PHAsset:</h2><p><strong>PHAsset</strong>: ä»£è¡¨ç…§ç‰‡åº“ä¸­çš„ä¸€ä¸ªèµ„æºï¼Œè·Ÿ ALAsset ç±»ä¼¼ï¼Œé€šè¿‡ PHAsset å¯ä»¥è·å–å’Œä¿å­˜èµ„æº<br><strong>PHFetchOptions</strong>: è·å–èµ„æºæ—¶çš„å‚æ•°ï¼Œå¯ä»¥ä¼  nilï¼Œå³ä½¿ç”¨ç³»ç»Ÿé»˜è®¤å€¼</p>
<pre><code>//åšé€‰æ‹©çš„çº¦æŸæ¡ä»¶ã€‚æ¯”å¦‚ï¼Œåªè·å–å›¾ç‰‡ï¼Œä¸è·å–è§†é¢‘ã€‚
 phopt.predicate = [NSPredicate predicateWithFormat:@&quot;mediaType == %d&quot;,PHAssetMediaTypeImage];//åªå–å›¾ç‰‡

//æŒ‰å¯æŒ‡å®šå­—æ®µç”¨æ¥å¯¹è·å–ç»“æœè¿›è¡Œæ’åº
phopt.sortDescriptors = @[[NSSortDescriptor sortDescriptorWithKey:@&quot;creationDate&quot; ascending:YES]]; // æŒ‰å›¾ç‰‡ç”Ÿæˆæ—¶é—´æ’åº
phopt.includeHiddenAssets = YES;//è·å–ç»“æœæ˜¯å¦åŒ…æ‹¬è¢«éšè—çš„èµ„æº
phopt.includeAllBurstAssets = YES;//è·å–ç»“æœæ˜¯å¦åŒ…æ‹¬è¿æ‹èµ„æº
phopt.wantsIncrementalChangeDetails = YES;//å…è®¸å˜åŒ–ç»†èŠ‚ï¼Ÿ
</code></pre><p><strong>PHFetchResult</strong>: è¡¨ç¤ºä¸€ç³»åˆ—çš„èµ„æºé›†åˆï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å†Œçš„é›†åˆï¼Œå¯ä»¥ç”¨ç±»ä¼¼ NSArray çš„æ¥å£æ¥è®¿é—®PHFetchResultç»“æœå†…çš„é›†åˆã€‚</p>
<pre><code>PHFetchResult *albums = [PHAssetCollection fetchAssetCollectionsWithType:PHAssetCollectionTypeSmartAlbum subtype:PHAssetCollectionSubtypeSmartAlbumAllHidden options:nil];
</code></pre><p><strong>PHAssetCollection</strong>: è¡¨ç¤ºä¸€ä¸ªç›¸å†Œæˆ–è€…ä¸€ä¸ªæ—¶åˆ»ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªã€Œæ™ºèƒ½ç›¸å†Œï¼ˆç³»ç»Ÿæä¾›çš„ç‰¹å®šçš„ä¸€ç³»åˆ—ç›¸å†Œï¼Œä¾‹å¦‚ï¼šæœ€è¿‘åˆ é™¤ï¼Œè§†é¢‘åˆ—è¡¨ï¼Œæ”¶è—ç­‰ç­‰ï¼‰,ä¸‹é¢æ˜¯ä¸€äº›åªè¯»å±æ€§</p>
<p>######assetCollectionType èµ„æºé›†åˆç±»å‹ï¼Œæ¯”å¦‚ç›¸å†Œæˆ–è€…â€œæ—¶åˆ»â€ç›¸å†Œï¼Œ</p>
<pre><code>enum PHAssetCollectionType : Int {

case Album //ä» iTunes åŒæ­¥æ¥çš„ç›¸å†Œï¼Œä»¥åŠç”¨æˆ·åœ¨ Photos ä¸­è‡ªå·±å»ºç«‹çš„ç›¸å†Œ
case SmartAlbum //ç»ç”±ç›¸æœºå¾—æ¥çš„ç›¸å†Œ
case Moment //Photos ä¸ºæˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆçš„æ—¶é—´åˆ†ç»„çš„ç›¸å†Œ

}
</code></pre><p>######assetCollectionSubtype å­ç±»å‹</p>
<pre><code>  enum PHAssetCollectionSubtype : Int {
case AlbumRegular //ç”¨æˆ·åœ¨ Photos ä¸­åˆ›å»ºçš„ç›¸å†Œ
case AlbumSyncedEvent //ä½¿ç”¨ iTunes ä» Photos ç…§ç‰‡åº“æˆ–è€… iPhoto ç…§ç‰‡åº“åŒæ­¥è¿‡æ¥çš„äº‹ä»¶ã€‚ç„¶è€Œï¼Œåœ¨iTunes 12 ä»¥åŠiOS 9.0 beta4ä¸Šï¼Œé€‰ç”¨è¯¥ç±»å‹æ²¡æ³•è·å–åŒæ­¥çš„äº‹ä»¶ç›¸å†Œï¼Œè€Œå¿…é¡»ä½¿ç”¨AlbumSyncedAlbumã€‚
case AlbumSyncedFaces //ä½¿ç”¨ iTunes ä» Photos ç…§ç‰‡åº“æˆ–è€… iPhoto ç…§ç‰‡åº“åŒæ­¥çš„äººç‰©ç›¸å†Œã€‚
case AlbumSyncedAlbum //åšäº† AlbumSyncedEvent åº”è¯¥åšçš„äº‹
case AlbumImported //ä»ç›¸æœºæˆ–æ˜¯å¤–éƒ¨å­˜å‚¨å¯¼å…¥çš„ç›¸å†Œï¼Œå®Œå…¨æ²¡æœ‰è¿™æ–¹é¢çš„ä½¿ç”¨ç»éªŒï¼Œæ²¡æ³•éªŒè¯ã€‚
case AlbumMyPhotoStream //ç”¨æˆ·çš„ iCloud ç…§ç‰‡æµ
case AlbumCloudShared //ç”¨æˆ·ä½¿ç”¨ iCloud å…±äº«çš„ç›¸å†Œ
case SmartAlbumGeneric //æ–‡æ¡£è§£é‡Šä¸ºéç‰¹æ®Šç±»å‹çš„ç›¸å†Œï¼Œä¸»è¦åŒ…æ‹¬ä» iPhoto åŒæ­¥è¿‡æ¥çš„ç›¸å†Œã€‚
case SmartAlbumPanoramas //ç›¸æœºæ‹æ‘„çš„å…¨æ™¯ç…§ç‰‡
case SmartAlbumVideos //ç›¸æœºæ‹æ‘„çš„è§†é¢‘
case SmartAlbumFavorites //æ”¶è—æ–‡ä»¶å¤¹
case SmartAlbumTimelapses //å»¶æ—¶è§†é¢‘æ–‡ä»¶å¤¹ï¼ŒåŒæ—¶ä¹Ÿä¼šå‡ºç°åœ¨è§†é¢‘æ–‡ä»¶å¤¹ä¸­
case SmartAlbumAllHidden //åŒ…å«éšè—ç…§ç‰‡æˆ–è§†é¢‘çš„æ–‡ä»¶å¤¹
case SmartAlbumRecentlyAdded //ç›¸æœºè¿‘æœŸæ‹æ‘„çš„ç…§ç‰‡æˆ–è§†é¢‘
case SmartAlbumBursts //è¿æ‹æ¨¡å¼æ‹æ‘„çš„ç…§ç‰‡
case SmartAlbumUserLibrary //è¿™ä¸ªå‘½åæœ€ç¥å¥‡äº†ï¼Œå°±æ˜¯ç›¸æœºç›¸å†Œï¼Œæ‰€æœ‰ç›¸æœºæ‹æ‘„çš„ç…§ç‰‡æˆ–è§†é¢‘éƒ½ä¼šå‡ºç°åœ¨è¯¥ç›¸å†Œä¸­ï¼Œè€Œä¸”ä½¿ç”¨å…¶ä»–åº”ç”¨ä¿å­˜çš„ç…§ç‰‡ä¹Ÿä¼šå‡ºç°åœ¨è¿™é‡Œã€‚
case Any //åŒ…å«æ‰€æœ‰ç±»å‹

}
</code></pre><p>######estimatedAssetCount ï¼šä¼°ç®—çš„assetæ•°é‡ï¼Œä¸ç²¾ç¡®</p>
<p><strong>PHImageManager</strong>: ç”¨äºå¤„ç†èµ„æºçš„åŠ è½½ï¼ŒåŠ è½½å›¾ç‰‡çš„è¿‡ç¨‹å¸¦æœ‰ç¼“å­˜å¤„ç†ï¼Œå¯ä»¥é€šè¿‡ä¼ å…¥ä¸€ä¸ª PHImageRequestOptions æ§åˆ¶èµ„æºçš„è¾“å‡ºå°ºå¯¸ç­‰è§„æ ¼ï¼Œåœ¨æ¡†æ¶ä¸­æ˜¯ä¸ªå•ä¾‹å¯¹è±¡ï¼Œç”¨[PHImageManager defaultManager]è·å–,å®ƒæä¾›äº†åŠ è½½å›¾ç‰‡å’Œè§†é¢‘çš„æ–¹æ³•,</p>
<p><strong>PHImageRequestOptions</strong>: å¦‚ä¸Šé¢æ‰€è¯´ï¼Œæ§åˆ¶åŠ è½½å›¾ç‰‡æ—¶çš„ä¸€ç³»åˆ—å‚æ•°</p>
<pre><code> PHImageRequestOptions  *options= [PHImageRequestOptions new];
 //è¿™ä¸ªå±æ€§æ˜¯æŒ‡è·å–çš„å›¾åƒæ˜¯å¦éœ€è¦åŒ…å«ç³»ç»Ÿç›¸å†Œâ€œç¼–è¾‘â€åŠŸèƒ½å¤„ç†è¿‡çš„ä¿¡æ¯ï¼ˆå¦‚æ»¤é•œï¼Œæ—‹è½¬ç­‰ï¼‰
options.version = PHImageRequestOptionsVersionCurrent;
options.deliveryMode = PHImageRequestOptionsDeliveryModeHighQualityFormat;
/*
 PHImageRequestOptionsDeliveryModeOpportunistic = 0,å›¾ç‰‡è·å–é€Ÿåº¦å’Œè´¨é‡çš„å¹³è¡¡
 PHImageRequestOptionsDeliveryModeHighQualityFormat = 1,é«˜è´¨é‡å›¾ç‰‡,
 PHImageRequestOptionsDeliveryModeFastFormat = 2 å¿«é€Ÿå¾—åˆ°å›¾ç‰‡çš„æƒ…å†µä¸‹ä¿è¯è´¨é‡
 */

options.resizeMode = PHImageRequestOptionsResizeModeExact;
/*
 PHImageRequestOptionsResizeModeNone = 0,ä¸å‹ç¼©
 PHImageRequestOptionsResizeModeFast,é«˜æ•ˆç‡è¯·æ±‚,ä½†æ˜¯è¿”å›çš„å›¾ç‰‡å°ºå¯¸å¯èƒ½å’Œè¦æ±‚çš„å°ºå¯¸ä¸åŒ
 PHImageRequestOptionsResizeModeExact,æŒ‰ç…§ç²¾å‡†å°ºå¯¸è¿”å›
 */

// åŒæ­¥è·å¾—å›¾ç‰‡, åªä¼šè¿”å›1å¼ å›¾ç‰‡,PS: è‹¥options.synchronous = YES,åˆ™ä¸è®ºoptions.deliveryModeå¦‚ä½•è®¾ç½®,ç³»ç»Ÿä¼šé€‰æ‹©PHImageRequestOptionsDeliveryModeHighQualityFormat(é«˜è´¨é‡å›¾ç‰‡)
options.synchronous = YES;
//æ˜¯å¦è”ç½‘è·å–iCloudçš„å›¾ç‰‡
options.networkAccessAllowed = NO;
//æŒ‡å®šä½œç‰©çŸ©å½¢å•å…ƒåæ ‡çš„åŸå§‹å›¾åƒ,å¦‚çš„è„¸ã€‚é»˜è®¤ä¸ºCGRectZero(ä¸é€‚ç”¨)
options.normalizedCropRect = CGRectMake(100, 200, 100, 100);

options.progressHandler
//ä¸€ä¸ª PHAssetImageProgressHandler çš„ blockï¼Œå½“ä» iCloud ä¸‹è½½ç…§ç‰‡æ—¶ï¼Œå®ƒå°±ä¼šè¢«å›¾åƒç®¡ç†å™¨è‡ªåŠ¨è°ƒç”¨è¿˜æœ‰ä¸€ä¸ªä¸ iCloud å¯†åˆ‡ç›¸å…³çš„å±æ€§å½“å›¾åƒéœ€è¦ä» iCloud ä¸‹è½½æ—¶ï¼Œè¿™ä¸ª block ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ï¼Œblock ä¸­ä¼šè¿”å›å›¾åƒä¸‹è½½çš„è¿›åº¦ï¼Œå›¾åƒçš„ä¿¡æ¯ï¼Œå‡ºé”™ä¿¡æ¯ã€‚å¼€å‘è€…å¯ä»¥åˆ©ç”¨è¿™äº›ä¿¡æ¯åé¦ˆç»™ç”¨æˆ·å½“å‰å›¾åƒçš„ä¸‹è½½è¿›åº¦ä»¥åŠçŠ¶å†µï¼Œä½†éœ€è¦æ³¨æ„?progressHandler ä¸åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œå› æ­¤åœ¨å…¶ä¸­éœ€è¦æ“ä½œ UIï¼Œåˆ™éœ€è¦æ‰‹å·¥æ”¾åˆ°ä¸»çº¿ç¨‹æ‰§è¡Œã€‚
options.progressHandler
</code></pre><p><a href="http://kayosite.com/ios-development-and-detail-of-photo-framework-part-two.html" target="_blank" rel="external">æ›´è¯¦ç»†çš„æˆ³è¿™é‡Œ</a></p>
<p><a href="https://objccn.io/issue-21-4/" target="_blank" rel="external">è¿™ä¸ªç¿»è¯‘ä¹Ÿå¾ˆç›´ç™½</a></p>
<p>å½“ç„¶ï¼Œè¿˜æœ‰PHImageCachingManager ç”¨äºå¤„ç†å›¾åƒçš„ç¼“å­˜è¿™é‡Œå°±ä¸è¯´äº†ï½ï½<br>æœ€åï¼ŒæŒ‚ä¸ªå›¾ï¼š<br><img src="http://kayosite.com/wp-content/uploads/2015/09/ios8-photo-kit.png" alt="PhotoKitæ„æˆ"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">


      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/child/2016/11/11/runtimeåˆä½“éªŒ-å…³è”/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="hapii">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://tva1.sinaimg.cn/crop.0.14.750.750.180/005PluWajw8fahgdnankoj30ku0lnjsd.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸è¦æ€¥ï¼Œä¸è¦æ€•">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸è¦æ€¥ï¼Œä¸è¦æ€•" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/11/runtimeåˆä½“éªŒ-å…³è”/" itemprop="url">
                  runtimeåˆä½“éªŒ--å…³è”
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-11T16:46:40+08:00">
                2016-11-11
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/11/11/runtimeåˆä½“éªŒ-å…³è”/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/11/runtimeåˆä½“éªŒ-å…³è”/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/11/11/runtimeåˆä½“éªŒ-å…³è”/" class="leancloud_visitors" data-flag-title="runtimeåˆä½“éªŒ--å…³è”">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•° </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>å¯¹è±¡å…³è”ï¼ˆæˆ–ç§°ä¸ºå…³è”å¼•ç”¨ï¼‰æœ¬æ¥æ˜¯Objective-C 2.0è¿è¡Œæ—¶çš„ä¸€ä¸ªç‰¹æ€§ï¼Œèµ·å§‹äºOS X Snow Leopardå’ŒiOS 4ã€‚ç›¸å…³å‚è€ƒå¯ä»¥æŸ¥çœ‹ <objc runtime.h=""> ä¸­å®šä¹‰çš„ä»¥ä¸‹ä¸‰ä¸ªå…è®¸ä½ å°†ä»»ä½•é”®å€¼åœ¨è¿è¡Œæ—¶å…³è”åˆ°å¯¹è±¡ä¸Šçš„å‡½æ•°ï¼š</objc></p>
<p>objc_setAssociatedObject<br>objc_getAssociatedObject<br>objc_removeAssociatedObjects</p>
<p>ä»–å¯ä»¥å°†æŸä¸ªOCå¯¹è±¡é€šè¿‡ä¸€ä¸ªå”¯ä¸€çš„keyè¿æ¥åˆ°ä¸€ä¸ªç±»çš„å®ä¾‹ä¸Šï¼Œè¿™å…è®¸å¼€å‘è€…å¯¹å·²ç»å­˜åœ¨çš„ç±»åœ¨æ‰©å±•ä¸­æ·»åŠ è‡ªå®šä¹‰çš„å±æ€§ï¼Œè¿™å‡ ä¹å¼¥è¡¥äº†Objective-Cæœ€å¤§çš„ç¼ºç‚¹ã€‚</p>
<h2 id="ä¸¾ä¸ªæ —å­"><a href="#ä¸¾ä¸ªæ —å­" class="headerlink" title="ä¸¾ä¸ªæ —å­:"></a>ä¸¾ä¸ªæ —å­:</h2><p>é¦–å…ˆï¼Œå¼•å…¥#import <objc runtime.h=""></objc></p>
<p>åˆ›å»ºä¸€ä¸ªView<br>     UIView *view = [[UIView alloc]initWithFrame:CGRectMake(40,40 ,10 , 10)];<br> åˆ›å»ºä¸€ä¸ªç§»åŠ¨æ‰‹åŠ¿ï¼š</p>
<pre><code>self.pan = [[UIPanGestureRecognizer alloc]initWithTarget:self action:@selector(panGesture:)];
</code></pre><p>å°†viewå’Œ é¢œè‰²è¿™ä¸¤ä¸ªå±æ€§æ·»åŠ åˆ°æ‰‹åŠ¿è¿™ä¸ªå¯¹è±¡ä¸Šï¼š</p>
<pre><code>typedef OBJC_ENUM(uintptr_t, objc_AssociationPolicy) {
OBJC_ASSOCIATION_ASSIGN = 0,           /**&lt; Specifies a weak reference to the associated object. */
OBJC_ASSOCIATION_RETAIN_NONATOMIC = 1, /**&lt; Specifies a strong reference to the associated object. 
                                        *   The association is not made atomically. */
OBJC_ASSOCIATION_COPY_NONATOMIC = 3,   /**&lt; Specifies that the associated object is copied. 
                                        *   The association is not made atomically. */
OBJC_ASSOCIATION_RETAIN = 01401,       /**&lt; Specifies a strong reference to the associated object.
                                        *   The association is made atomically. */
OBJC_ASSOCIATION_COPY = 01403          /**&lt; Specifies that the associated object is copied.
                                        *   The association is made atomically. */
};    
</code></pre><p>è¿™é‡Œobjc_AssociationPolicyæ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹çš„æ•°æ®ç»“æ„å®šä¹‰äº†OBJC_ASSOCIATION_ASSIGNã€OBJC_ASSOCIATION_RETAIN_NONATOMICã€OBJC_ASSOCIATION_COPY_NONATOMICã€<br>OBJC_ASSOCIATION_RETAINå’Œ<br>OBJC_ASSOCIATION_COPYè¿™æ ·äº”ä¸ªå…³è”å¯¹è±¡ç‰¹æ€§ï¼Œæ¯ä¸ªç‰¹æ€§çš„æè¿°å¦‚ä¸‹ï¼š</p>
<p>OBJC_ASSOCIATION_ASSIGN,ç»™å…³è”å¯¹è±¡æŒ‡å®šå¼±å¼•ç”¨,ç›¸å½“äº@property(assign)æˆ–@property(unsafe_unretained)</p>
<p>OBJC_ASSOCIATION_RETAIN_NONATOMIC,ç»™å…³è”å¯¹è±¡æŒ‡å®šéåŸå­çš„å¼ºå¼•ç”¨,ç›¸å½“äº@property(nonatomic,strong)æˆ–@property(nonatomic,retain)</p>
<p>OBJC_ASSOCIATION_COPY_NONATOMIC,ç»™å…³è”å¯¹è±¡æŒ‡å®šéåŸå­çš„copyç‰¹æ€§,ç›¸å½“äº@property(nonatomic,copy)</p>
<p>OBJC_ASSOCIATION_RETAIN,ç»™å…³è”å¯¹è±¡æŒ‡å®šåŸå­å¼ºå¼•ç”¨,ç›¸å½“äº@property(atomic,strong)æˆ–@property(atomic,retain)</p>
<p>OBJC_ASSOCIATION_COPY,ç»™å…³è”å¯¹è±¡æŒ‡å®šåŸå­copyç‰¹æ€§,ç›¸å½“äº@property(atomic,copy)</p>
<pre><code>objc_setAssociatedObject(self.pan, &quot;firstObject&quot;, view, OBJC_ASSOCIATION_RETAIN_NONATOMIC);
objc_setAssociatedObject(self.pan, &quot;secondObject&quot;, view.backgroundColor, OBJC_ASSOCIATION_RETAIN_NONATOMIC); OBJC_ASSOCIATION_RETAIN_NONATOMIC);
</code></pre><p>åœ¨æ‰‹åŠ¿ç§»åŠ¨çš„æ–¹æ³•-(void)panGesture:(UIPanGestureRecognizer *)panä¸­å®ç°ï¼š</p>
<pre><code>UIView *view = objc_getAssociatedObject(pan, &quot;firstObject&quot;);
    UIColor *color = objc_getAssociatedObject(pan, &quot;secondObject&quot;);
     objc_removeAssociatedObjects(pan);
</code></pre><p>è¿™æ ·å°±çš„åˆ°äº†ä¸¤ä¸ªå±æ€§ã€‚ä»€ä¹ˆï¼Œé€šè¿‡view.backgroundcolorå°±å¯ä»¥ç›´æ¥å¾—åˆ°è¿™ä¸¤ä¸ªå±æ€§äº†ï¼Ÿåªæ˜¯ä¸ªä¾‹å­ï¼Œç›®çš„æ˜¯è¦çœ‹æ‡‚ï¼ï¼get,setæœ‰æ²¡æœ‰å¾ˆç†Ÿæ‚‰å‘¢ï¼Ÿ</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯objc_removeAssociatedObjects å‡½æ•°æˆ‘ä»¬ä¸€èˆ¬æ˜¯ç”¨ä¸ä¸Šçš„ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°ä¼šç§»é™¤ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å…³è”å¯¹è±¡ï¼Œå°†è¯¥å¯¹è±¡æ¢å¤æˆâ€œåŸå§‹â€çŠ¶æ€ã€‚è¿™æ ·åšå°±å¾ˆæœ‰å¯èƒ½æŠŠåˆ«äººæ·»åŠ çš„å…³è”å¯¹è±¡ä¹Ÿä¸€å¹¶ç§»é™¤ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æ‰€å¸Œæœ›çš„ã€‚æ‰€ä»¥ä¸€èˆ¬çš„åšæ³•æ˜¯é€šè¿‡ç»™ objc_setAssociatedObject å‡½æ•°ä¼ å…¥ nil æ¥ç§»é™¤æŸä¸ªå·²æœ‰çš„å…³è”å¯¹è±¡ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">


      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/child/2016/11/10/cellçš„å¤ç”¨/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="hapii">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://tva1.sinaimg.cn/crop.0.14.750.750.180/005PluWajw8fahgdnankoj30ku0lnjsd.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸è¦æ€¥ï¼Œä¸è¦æ€•">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸è¦æ€¥ï¼Œä¸è¦æ€•" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/10/cellçš„å¤ç”¨/" itemprop="url">
                  cellçš„å¤ç”¨
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-10T11:20:09+08:00">
                2016-11-10
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/11/10/cellçš„å¤ç”¨/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/10/cellçš„å¤ç”¨/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/11/10/cellçš„å¤ç”¨/" class="leancloud_visitors" data-flag-title="cellçš„å¤ç”¨">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•° </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="cellåˆ›å»ºçš„å‡ ç§æ–¹å¼"><a href="#cellåˆ›å»ºçš„å‡ ç§æ–¹å¼" class="headerlink" title="cellåˆ›å»ºçš„å‡ ç§æ–¹å¼:"></a>cellåˆ›å»ºçš„å‡ ç§æ–¹å¼:</h2><p>1.æœ€å¸¸è§çš„æ–¹æ³•:</p>
<pre><code>NoDataTbViewCell *cell =[tableView dequeueReusableCellWithIdentifier:@&quot;noDataCell&quot;];
    cell.delegate = self;
   if (cell==nil) {
       cell = [[NoDataTbViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@&quot;noDataCell&quot;];
   }
   return cell;
</code></pre><p>2.æ³¨å†Œï¼š<br>å…ˆåœ¨ç»™tableViewè®¾ç½®delegateä¹‹å‰æ³¨å†Œcellï¼š    </p>
<pre><code>xibçš„ï¼š[self.tableView registerNib:[UINib nibWithNibName:NSStringFromClass([VideoTableViewCell class]) bundle:nil] forCellReuseIdentifier:VideoCell];

ä»£ç çš„ï¼š [self.tableView registerClass:[VideoTableViewCell class] forCellReuseIdentifier:VideoCell];
</code></pre><p>ç„¶å cellForRowAtIndexPath:é‡Œ</p>
<pre><code>VideoTableViewCell *cell  = [tableView dequeueReusableCellWithIdentifier:identifier];
</code></pre><p>3.xibæœ¬åœ°åŠ è½½ï¼š</p>
<pre><code>VideoTableViewCell *cell           = [tableView dequeueReusableCellWithIdentifier:identifier ];
   if (cell==nil) {
       cell = [[[NSBundle mainBundle] loadNibNamed:@&quot;VideoTableViewCell&quot; owner:self options:nil] lastObject];
       }    
</code></pre><h2 id="cellå¤ç”¨åŸç†"><a href="#cellå¤ç”¨åŸç†" class="headerlink" title="cellå¤ç”¨åŸç†:"></a>cellå¤ç”¨åŸç†:</h2><p>è¯´èµ·å¤ç”¨å°±å¿…é¡»è¦è¯´ä¸€ä¸‹dequeueReusableCellWithIdentifier:è¿™ä¸ªå‡½æ•°ï¼Œåœ¨iOS 6ä¸­dequeueReusableCellWithIdentifier:è¢«dequeueReusableCellWithIdentifier:forIndexPath:æ‰€å–ä»£ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œåœ¨è¡¨æ ¼è§†å›¾ä¸­åˆ›å»ºå¹¶æ·»åŠ UITableViewCellå¯¹è±¡ä¼šå˜å¾—æ›´ä¸ºç²¾ç®€è€Œæµç•…ã€‚è€Œä¸”ä½¿ç”¨dequeueReusableCellWithIdentifier:forIndexPath:ä¸€å®šä¼šè¿”å›cellï¼Œç³»ç»Ÿåœ¨é»˜è®¤æ²¡æœ‰cellå¯å¤ç”¨çš„æ—¶å€™ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°çš„cellå‡ºæ¥ã€‚ä½†æ˜¯ä½¿ç”¨dequeueReusableCellWithIdentifier:forIndexPath:çš„è¯ï¼Œå¿…é¡»è¦å’Œæ³¨å†Œé…åˆä½¿ç”¨</p>
<p>dequeueReusableCellWithIdentifieræ¶ˆæ¯è¿”å›çš„æ˜¯UITableViewCellå¯¹è±¡ï¼Œå³æ˜¯è¯´è¿™æ˜¯ä¸€ä¸ªç”¨æ¥è·å–UITableViewCellå¯¹è±¡çš„æ¶ˆæ¯ï¼Œä¹‹æ‰€ä»¥ä¸è¯´æ˜¯åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯å› ä¸ºå®ƒå¯èƒ½è¿”å›nilå€¼ï¼Œæ‰€ä»¥æ‰è¦åœ¨ä¸‹é¢è¡¥å……ä¸€ä¸ªå¦‚æœcellä¸ºnilæ—¶çš„å¤„ç†è¿‡ç¨‹ã€‚</p>
<p>é‚£ä¹ˆè¿™ä¸ªæ–¹æ³•æ˜¯ä¸æ˜¯å¯ä»¥è§£é‡Šæˆä¸ºï¼Œä»ä¸€ä¸ªUITableViewCellå¯¹è±¡æ± ä¸­è·å–ä¸€ä¸ªä»¥Identifierå‚æ•°å‘½åçš„UITableViewCellå¯¹è±¡ã€‚<br>å¦‚æœåœ¨èµ„æºç´§ç¼ºçš„æ—¶å€™ï¼Œè¿™ä¸ªæ± ä¼šè‡ªåŠ¨æ¸…ç†å¤šä½™çš„UITableViewCellå¯¹è±¡ï¼Œåˆ™å¯èƒ½æ— æ³•è¿”å›å¯¹è±¡ï¼Œä½†å¦‚æœèµ„æºä¸°å¯Œï¼Œåˆ™ä¼šä¿å­˜ä¸€äº›UITableViewCellå¯¹è±¡ï¼Œåœ¨éœ€è¦è°ƒç”¨çš„æ—¶å€™è¿…é€Ÿçš„è¿”å›ï¼Œè€Œä¸ç”¨åˆ›å»ºã€‚</p>
<p>dequeueReusableCellWithIdentifierï¼Œä»å­—é¢ä¸Šç†è§£æ˜¯â€œå‡ºåˆ—çš„å¯é‡ç”¨çš„cellâ€ï¼Œå…¶å®ç®€å•è¯´å°±æ˜¯ä¸€ä¸ªcellæ± ï¼Œé‡Œé¢æ”¾çš„å°±æ˜¯ä½ ä¹‹å‰åˆ›å»ºè¿‡çš„cellã€‚ä½¿ç”¨æ—¶è¦æ³¨æ„ï¼š<br>1ã€‚é‡å–å‡ºæ¥çš„cellæ˜¯æœ‰å¯èƒ½å·²ç»æ†ç»‘è¿‡æ•°æ®æˆ–è€…åŠ è¿‡å­è§†å›¾çš„ï¼Œæ‰€ä»¥ï¼Œå¦‚æœæœ‰å¿…è¦ï¼Œè¦æ¸…é™¤æ•°æ®ï¼ˆæ¯”å¦‚textlabelçš„textï¼‰å’Œremoveæ‰addè¿‡çš„å­è§†å›¾ï¼ˆä½¿ç”¨tagã€‚æ‰€ä»¥åœ¨ç»™cellçš„æ¨¡å‹èµ‹å€¼çš„æ—¶å€™ä¸€äº›é€»è¾‘æœ€å¥½æ”¾åœ¨ifï¼ˆcell==nilï¼‰é‡Œå»æ‰§è¡Œ.<br>2ã€‚è¿™æ ·è®¾è®¡çš„ç›®çš„æ˜¯ä¸ºäº†é¿å…é¢‘ç¹çš„ allocå’Œdelloc cellå¯¹è±¡è€Œå·²,æ²¡æœ‰å¤šå¤æ‚ã€‚<br>3ã€‚è®¾è®¡çš„å…³é”®æ˜¯å®ç°cellå’Œæ•°æ®çš„å®Œå…¨åˆ†ç¦»</p>
<p>å…³é”®ç‚¹åœ¨â€ä¸€ä¸ªå±å¹•æ˜¾ç¤ºçš„cellæ•°é‡â€æ˜¯æœ‰é™çš„<br>å½“å±å¹•æ»šåŠ¨æ—¶å€™ï¼Œå°±ä¼šè°ƒç”¨æ–¹æ³•è·å–æ–°çš„cellï¼Œè€Œè€çš„cellä¼šåœ¨å±å¹•å¤–é¢å°±ä¸æ˜¾ç¤ºäº†</p>
<p>reuseæœºåˆ¶å°±æ˜¯è¿™æ ·ã€‚å½“celléœ€è¦æ˜¾ç¤ºçš„æ—¶å€™ï¼Œä»queueé‡Œé¢æ‰¾ï¼Œæ‰¾åˆ°äº†ï¼Œè®¾ç½®ä¸€ä¸‹å†…å®¹ï¼Œæ˜¾ç¤ºå‡ºæ¥<br>æ»šåŠ¨ç•Œé¢å½“æœ‰cellè¢«ç§»å‡ºå±å¹•æ—¶ï¼ŒæŠŠè¿™ä¸ªcellä¸¢åˆ°queueé‡Œé¢<br>æ˜¾ç¤ºæ–°çš„cellæ—¶ï¼Œå¦‚æœæœ‰â€œç›¸åŒç±»å‹â€(identifier)çš„cellï¼Œå°±ä»é˜Ÿåˆ—æ‹¿ä¸€ä¸ªå‡ºæ¥ï¼Œè®¾ç½®æ•°æ®ï¼Œæ˜¾ç¤ºå‡ºæ¥<br>è‡³äºqueueé‡Œé¢ä¼šæœ‰å¤šå°‘cellï¼Œè¿™ä¸ªä¼šè‡ªåŠ¨æ§åˆ¶</p>
<p>è¦æ³¨æ„çš„æ˜¯ï¼Œqueueé‡Œé¢å­˜å‚¨çš„æ˜¯cellçš„å®ä¾‹ï¼Œä¸æ˜¯â€œåŸå‹â€<br>å› æ­¤å°±ä¼šå‡ºç°ä¸Šé¢è¯´çš„â€œå‡è®¾æ¯é¡µæœ‰ 5ä¸ªã€‚ åˆ™ ç¬¬6ä¸ªå¤ç”¨ç¬¬1ä¸ªcellï¼› ç¬¬7ä¸ªå¤ç”¨ç¬¬2ä¸ªï¼›â€<br>è¿™æ ·çš„ç»“æœæ˜¯ä¸ç®¡ä½ çš„tableæœ‰å¤šå°‘è¡Œï¼Œå†…å­˜é‡Œå®é™…ä¸Šéƒ½åªéœ€è¦å­˜å‚¨ä¸€ä¸ªå±å¹•é‚£ä¹ˆå¤šè¡Œçš„cellå°±æå®šäº†ã€‚ã€‚</p>
<p><a href="http://blog.csdn.net/dong_007_007/article/details/7580392" target="_blank" rel="external">éƒ¨åˆ†é“¾æ¥</a></p>
<h2 id="tableViewçš„æ‰§è¡Œè¿‡ç¨‹"><a href="#tableViewçš„æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="tableViewçš„æ‰§è¡Œè¿‡ç¨‹:"></a>tableViewçš„æ‰§è¡Œè¿‡ç¨‹:</h2><p>è°ƒç”¨numberOfSectionè·å¾— Aä¸ª section<br>å…ˆè°ƒç”¨numberOfRowsInSectionè·å¾—Bä¸ªcell,å†è°ƒç”¨heightForRowBæ¬¡ã€‚å¦‚æ­¤å¾ªç¯Aæ¬¡<br>å¾ªç¯è°ƒç”¨cellForRowå’ŒheightForRowï¼Œç›´åˆ°cellçš„ä¸ªæ•°å……æ»¡å½“å‰å±å¹•ã€‚</p>
<p><img src="http://images2015.cnblogs.com/blog/527522/201607/527522-20160727174550903-992232741.png" alt="é™„tableViewä»£ç†æ–¹æ³•è¡¨"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">


      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/child/2016/11/04/ä¸‹AFNå¤§é‡çˆ†çº¢/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="hapii">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://tva1.sinaimg.cn/crop.0.14.750.750.180/005PluWajw8fahgdnankoj30ku0lnjsd.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸è¦æ€¥ï¼Œä¸è¦æ€•">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸è¦æ€¥ï¼Œä¸è¦æ€•" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/04/ä¸‹AFNå¤§é‡çˆ†çº¢/" itemprop="url">
                  leaksä¸‹AFNå¤§é‡çˆ†çº¢
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-04T11:11:27+08:00">
                2016-11-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/æ—¥å¸¸Bug/" itemprop="url" rel="index">
                    <span itemprop="name">æ—¥å¸¸Bug</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/11/04/ä¸‹AFNå¤§é‡çˆ†çº¢/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/04/ä¸‹AFNå¤§é‡çˆ†çº¢/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/11/04/ä¸‹AFNå¤§é‡çˆ†çº¢/" class="leancloud_visitors" data-flag-title="leaksä¸‹AFNå¤§é‡çˆ†çº¢">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•° </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>leaksæ˜¯Xcodeçš„Instrumentsé‡Œé¢æœ‰ä¸€ä¸ªLeakså·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ å®šä½å‘ç”Ÿå†…å­˜æ³„æ¼çš„ä»£ç æ®µï¼Œä»¥ä¾¿ä¿®å¤é—®é¢˜ã€‚æ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å·¥å…·ã€‚ä½¿ç”¨æ–¹æ³•(æ›´è¯¦ç»†çš„è‡ªè¡Œç™¾åº¦æˆ–<a href="http://www.jianshu.com/p/c0aa12d91f05" target="_blank" rel="external">ç‚¹è¿™é‡Œ</a>)ï¼š<br>1.å…ˆç‚¹å¼€è¿™ä¸ª<br><img src="http://7xrn7f.com1.z0.glb.clouddn.com/16-11-4/44034669.jpg" alt="1.å…ˆç‚¹å¼€è¿™ä¸ª"></p>
<p>2.ç„¶åé€‰æ‹©äº†è¿™ä¸ª<br><img src="http://7xrn7f.com1.z0.glb.clouddn.com/16-11-4/63840634.jpg" alt="2.ç„¶åé€‰æ‹©äº†è¿™ä¸ª"><br>3.ç‚¹å‡»åˆ°æ—è¾¹çš„è®¾ç½®ï¼ŒæŠŠè¿™å‡ ä¸ªç‚¹äº†<br><img src="http://7xrn7f.com1.z0.glb.clouddn.com/16-11-4/7238907.jpg" alt="3.ç‚¹å‡»åˆ°æ—è¾¹çš„è®¾ç½®ï¼ŒæŠŠè¿™å‡ ä¸ªç‚¹äº†"><br>4.é€‰æ‹©è®¾å¤‡ï¼Œç‚¹å‡»çº¢ç‚¹è¿è¡Œ<br><img src="http://7xrn7f.com1.z0.glb.clouddn.com/16-11-4/36329608.jpg" alt="4.é€‰æ‹©è®¾å¤‡ï¼Œç‚¹å‡»çº¢ç‚¹è¿è¡Œ"><br>5.ä¸Šè¾¹ç‚¹å‡»åˆ°leaksï¼Œåœ¨æŠŠ2ç‚¹åˆ°call Treeçœ‹æ•ˆæœ<br><img src="http://7xrn7f.com1.z0.glb.clouddn.com/16-11-4/53899911.jpg" alt="5.ä¸Šè¾¹ç‚¹å‡»åˆ°leaksï¼Œåœ¨æŠŠ2ç‚¹åˆ°call Treeçœ‹æ•ˆæœ"><br>çˆ†çº¢çš„è¯ç›´æ¥åŒå‡»ä¸Šå›¾çš„ä»£ç ï¼Œä¸€èˆ¬å°±ä¼šè·³åˆ°å¯¹åº”çš„æ³„æ¼ä»£ç æ®µï¼Œä½†æ˜¯å¦‚æœæ˜¯è·³åˆ°äº†æ±‡ç¼–è¯­è¨€æ˜¯ä»€ä¹ˆé¬¼å‘¢ï¼Ÿï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œï¼Œï¼Œï¼‰<br>ä¸Šå›¾è¿è¡Œç»“æœå‘ç°å¤§éƒ¨åˆ†éƒ½æ˜¯AFNå†…å­˜æ³„æ¼ã€‚ã€‚</p>
<h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•:"></a>è§£å†³åŠæ³•:</h2><p><a href="http://www.jianshu.com/p/85b34695df15" target="_blank" rel="external">è¿™ä½å¤§å“¥è¯´çš„å¾ˆè¯¦ç»†ï¼Œæˆ‘å°±æ˜¯æŒ‰ä»–çš„åŠæ³•æ¥çš„</a><br>è¯¦ç»†æ–¹æ³•ï¼šç‚¹å‡»è¿™ä¸ªå‡½æ•°<br><code>AFHTTPSessionManager *manager = [AFHTTPSessionManager manager];</code><br>ä»¥å‰æ˜¯è¿™æ ·çš„ï¼š<br><code>+ (instancetype)manager {
    return [[[self class] alloc] initWithBaseURL:nil];
}</code><br>ç„¶åæˆ‘æŠŠå®ƒæ”¹æˆäº†è¿™æ ·çš„ï¼š<br><code>+ (instancetype)manager {
    //wqçj8æ”¹ï¼ŒæŠŠå®ƒæ”¹æˆå•ä¾‹
    static AFHTTPSessionManager *manager = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&amp;onceToken, ^{
        if (manager == nil) {
            manager = [[[self class] alloc] initWithBaseURL:nil];
        }
    });
    return manager;
}</code></p>
<p>å—¯ï¼ŒAFNæœç„¶æ²¡å•¦!<br><img src="http://7xrn7f.com1.z0.glb.clouddn.com/16-11-4/33327271.jpg" alt="ç»“æœ"></p>
<p>psï¼šæš‚æ—¶æ²¡æœ‰å‘ç°æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæµ‹è¯•å‡ å¤©çœ‹çœ‹ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">


      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/child/2016/10/31/iOSåŠ¨ç”»å­¦ä¹ ï¼ŒæŒç»­æ›´æ–°ing/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="hapii">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://tva1.sinaimg.cn/crop.0.14.750.750.180/005PluWajw8fahgdnankoj30ku0lnjsd.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸è¦æ€¥ï¼Œä¸è¦æ€•">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸è¦æ€¥ï¼Œä¸è¦æ€•" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/31/iOSåŠ¨ç”»å­¦ä¹ ï¼ŒæŒç»­æ›´æ–°ing/" itemprop="url">
                  iOSåŠ¨ç”»å­¦ä¹ ï¼ŒæŒç»­æ›´æ–°ing...
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-31T14:47:45+08:00">
                2016-10-31
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/10/31/iOSåŠ¨ç”»å­¦ä¹ ï¼ŒæŒç»­æ›´æ–°ing/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/31/iOSåŠ¨ç”»å­¦ä¹ ï¼ŒæŒç»­æ›´æ–°ing/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/10/31/iOSåŠ¨ç”»å­¦ä¹ ï¼ŒæŒç»­æ›´æ–°ing/" class="leancloud_visitors" data-flag-title="iOSåŠ¨ç”»å­¦ä¹ ï¼ŒæŒç»­æ›´æ–°ing...">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•° </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="CAEmitterLayer"><a href="#CAEmitterLayer" class="headerlink" title="CAEmitterLayer:"></a>CAEmitterLayer:</h2><p>######CAEmitterLayerç»§æ‰¿äº CALayeræ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ç²’å­å¼•æ“ï¼Œè¢«ç”¨æ¥åˆ›å»ºå®æ—¶ä¾‹å­åŠ¨ç”»å¦‚ï¼šçƒŸé›¾ï¼Œç«ï¼Œé›¨ç­‰ç­‰è¿™äº›æ•ˆæœã€‚ </p>
<p>######CAEmitterLayerçœ‹ä¸Šå»åƒæ˜¯è®¸å¤šCAEmitterCellçš„å®¹å™¨ï¼Œè¿™äº›CAEmitierCellå®šä¹‰äº†ä¸€ä¸ªä¾‹å­æ•ˆæœã€‚ä½ å°†ä¼šä¸ºä¸åŒçš„ä¾‹å­æ•ˆæœå®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªCAEmitterCellä½œä¸ºæ¨¡ç‰ˆï¼ŒåŒæ—¶CAEmitterLayerè´Ÿè´£åŸºäºè¿™äº›æ¨¡ç‰ˆå®ä¾‹åŒ–ä¸€ä¸ªç²’å­æµã€‚ä¸€ä¸ªCAEmitterCellç±»ä¼¼äºä¸€ä¸ªCALayerï¼šå®ƒæœ‰ä¸€ä¸ªcontentså±æ€§å¯ä»¥å®šä¹‰ä¸ºä¸€ä¸ªCGImageï¼Œå¦å¤–è¿˜æœ‰ä¸€äº›å¯è®¾ç½®å±æ€§æ§åˆ¶ç€è¡¨ç°å’Œè¡Œä¸ºã€‚æˆ‘ä»¬ä¸ä¼šå¯¹è¿™äº›å±æ€§é€ä¸€è¿›è¡Œè¯¦ç»†çš„æè¿°ï¼Œä½ ä»¬å¯ä»¥åœ¨CAEmitterCellç±»çš„å¤´æ–‡ä»¶ä¸­æ‰¾åˆ°ã€‚<br>é›ªèŠ±åŠ¨ç”»ï¼š</p>
<ul>
<li><p>(void)createSnow{</p>
<p> self.view.backgroundColor  = [UIColor blackColor];</p>
<p>// åˆ›å»ºç²’å­Layer<br>CAEmitterLayer *snowEmitter = [CAEmitterLayer layer];</p>
<p>// ç²’å­å‘å°„ä½ç½®<br>snowEmitter.emitterPosition = CGPointMake(120,20);</p>
<p>// å‘å°„æºçš„å°ºå¯¸å¤§å°<br>snowEmitter.emitterSize = self.view.bounds.size;</p>
<p>// å‘å°„æ¨¡å¼<br>snowEmitter.emitterMode = kCAEmitterLayerSurface;</p>
<p>// å‘å°„æºçš„å½¢çŠ¶<br>snowEmitter.emitterShape = kCAEmitterLayerLine;</p>
<p>// åˆ›å»ºé›ªèŠ±ç±»å‹çš„ç²’å­<br>CAEmitterCell *snowflake = [CAEmitterCell emitterCell];</p>
<p>// ç²’å­çš„åå­—<br>snowflake.name = @â€snowâ€;</p>
<p>// ç²’å­å‚æ•°çš„é€Ÿåº¦ä¹˜æ•°å› å­<br>snowflake.birthRate = 1.0;<br>snowflake.lifetime = 120.0;</p>
<p>// ç²’å­é€Ÿåº¦<br>snowflake.velocity =10.0;</p>
<p>// ç²’å­çš„é€Ÿåº¦èŒƒå›´<br>snowflake.velocityRange = 10;</p>
<p>// ç²’å­yæ–¹å‘çš„åŠ é€Ÿåº¦åˆ†é‡<br>snowflake.yAcceleration = 2;</p>
<p>// å‘¨å›´å‘å°„è§’åº¦<br>snowflake.emissionRange = 0.5 * M_PI;</p>
<p>// å­æ—‹è½¬è§’åº¦èŒƒå›´<br>snowflake.spinRange = 0.25 * M_PI;<br>snowflake.contents = (id)[[UIImage imageNamed:@â€snowâ€] CGImage];</p>
<p>// è®¾ç½®é›ªèŠ±å½¢çŠ¶çš„ç²’å­çš„é¢œè‰²<br>snowflake.color = [[UIColor whiteColor] CGColor];</p>
<p>snowflake.scaleRange = 0.6f;<br>snowflake.scale = 0.7f;</p>
<p>snowEmitter.shadowOpacity = 1.0;<br>snowEmitter.shadowRadius = 0.0;<br>snowEmitter.shadowOffset = CGSizeMake(0.0, 0.0);</p>
<p>// ç²’å­è¾¹ç¼˜çš„é¢œè‰²<br>snowEmitter.shadowColor = [[UIColor whiteColor] CGColor];</p>
<p>// æ·»åŠ ç²’å­<br>snowEmitter.emitterCells = @[snowflake];</p>
<p>// å°†ç²’å­Layeræ·»åŠ è¿›å›¾å±‚ä¸­<br>[self.view.layer addSublayer:snowEmitter];</p>
</li>
</ul>
<p>}</p>
<p>çƒŸèŠ±åŠ¨ç”»ï¼š</p>
<ul>
<li><p>(void)createFire{</p>
<p>  self.view.backgroundColor  = [UIColor blackColor];</p>
<p>  //åˆ›å»ºç²’å­<br>  CAEmitterLayer *fireworksEmitter = [CAEmitterLayer layer];<br>  //å–ä¸ªåæ ‡ç³»<br>  CGRect viewBounds = self.view.layer.bounds;</p>
</li>
</ul>
<pre><code>// ç²’å­å‘å°„ä½ç½®
fireworksEmitter.emitterPosition = \
CGPointMake(viewBounds.size.width/2.0, viewBounds.size.height);
// å‘¨å›´å‘å°„å¤§å°
fireworksEmitter.emitterSize    = CGSizeMake(viewBounds.size.width/2.0, 0.0);
// å‘¨å›´å‘å°„è§’åº¦
fireworksEmitter.emitterMode    = kCAEmitterLayerOutline;

 //å¸¸ç”¨çš„äº§ç”Ÿç²’å­æ¨¡å¼ ä¸‰ç§kCAEmitterLayerPoint ç‚¹ kCAEmitterLayerLineçº¿ kCAEmitterLayerRectangle çŸ©å½¢
fireworksEmitter.emitterShape    = kCAEmitterLayerLine;


fireworksEmitter.renderMode      = kCAEmitterLayerAdditive;

//ç”¨äºåˆå§‹åŒ–éšæœºæ•°ç”Ÿæˆçš„
fireworksEmitter.seed = (arc4random()%100)+1;

// Create the rocket
CAEmitterCell * rocket = [CAEmitterCell emitterCell];

rocket.birthRate        = 10;//æ¯ç§’äº§ç”Ÿ120ä¸ªç²’å­
rocket.emissionRange    = 0.25 * M_PI;  // //éšæœºæ–¹å‘ -pi/4 --- pi/4
rocket.velocity            = 380;  //åˆå§‹é€Ÿåº¦
rocket.velocityRange    = 100;    //éšæœºé€Ÿåº¦ -200+380 --- 200+380
rocket.yAcceleration    = 75;     //ç»™Yæ–¹å‘ä¸€ä¸ªåŠ é€Ÿåº¦
rocket.lifetime            = 1.02;   // å­˜æ´»1.02ç§’

rocket.contents            = (id) [[UIImage imageNamed:@&quot;DazRing&quot;] CGImage];
rocket.scale            = 0.2;
rocket.color            = [[UIColor redColor] CGColor];
rocket.greenRange        = 1.0;
rocket.redRange            = 1.0;       //ä¸‰ä¸ªéšæœºé¢œè‰²
rocket.blueRange        = 1.0;
rocket.spinRange        = M_PI;        // slow spin



// the burst object cannot be seen, but will spawn the sparks
// we change the color here, since the sparks inherit its value
CAEmitterCell *burst = [CAEmitterCell emitterCell];

burst.birthRate            = 1.0;        // at the end of travel
burst.velocity            = 0;           //åˆå§‹é€Ÿåº¦
burst.scale                = 2.5;        //
burst.redSpeed            =-1.5;        // é¢œè‰²å˜åŒ–æ•ˆæœ
burst.blueSpeed            =+1.5;        // é¢œè‰²å˜åŒ–æ•ˆæœ
burst.greenSpeed        =+1.0;        // é¢œè‰²å˜åŒ–æ•ˆæœ
burst.lifetime            = 0.35;      //å­˜æ´»0.35ç§’


// and finally, the sparks
CAEmitterCell* spark = [CAEmitterCell emitterCell];

spark.birthRate            = 400;          //æ¯ç§’äº§ç”Ÿ400ä¸ªç²’å­
spark.velocity            = 125;        //åˆå§‹é€Ÿåº¦
spark.emissionRange        = 2* M_PI;   //éšæœºæ–¹å‘  360 åº¦
spark.yAcceleration        = 75;        // gravity
spark.lifetime            = 3;          //å­˜æ´»3ç§’

spark.contents            = (id) [[UIImage imageNamed:@&quot;snow&quot;] CGImage];
spark.scaleSpeed        =-0.2;    //é€æ¸å˜å°

spark.greenSpeed        =-0.1;
spark.redSpeed            = 0.4;   //ä¸‰ç§éšæœºè‰²
spark.blueSpeed            =-0.1;

spark.alphaSpeed        =-0.25;     //é€æ¸æ¶ˆå¤±
spark.alphaRange           = 0.75;  //éšæœºé€æ˜åº¦
spark.spin                = 2* M_PI;
spark.spinRange            = 2* M_PI;

// å…¨éƒ¨åŠ èµ·æ¥
fireworksEmitter.emitterCells    = [NSArray arrayWithObject:rocket];
rocket.emitterCells                = [NSArray arrayWithObject:burst];
burst.emitterCells                = [NSArray arrayWithObject:spark];
[self.view.layer addSublayer:fireworksEmitter];
</code></pre><p>}</p>
<p>å›¾å°±ä¸è´´äº†ï¼Œä¸»è¦æ˜¯è¦çŸ¥é“å±æ€§çš„æ„æ€ã€‚</p>
<h2 id="åŸºç¡€åŠ¨ç”»CABasicAnimation"><a href="#åŸºç¡€åŠ¨ç”»CABasicAnimation" class="headerlink" title="åŸºç¡€åŠ¨ç”»CABasicAnimation:"></a>åŸºç¡€åŠ¨ç”»CABasicAnimation:</h2><p>ç»§æ‰¿äºCAPropertyAnimation,ä¸€ä¸‹ä»‹ç»å‡ ä¸ªå¸¸è§çš„ç†Ÿæ‚‰<br>keyPath åŠ¨ç”»æ–¹å¼ï¼ŒfromValue ä» toValue åˆ°   repeatCountæ‰§è¡ŒåŠ¨ç”»çš„æ¬¡æ•°ï¼ŒdurationæŒç»­æ—¶é—´ ,autoreversesæ˜¯å¦è‡ªåŠ¨å‘è½¬</p>
<p>//å…ˆåˆå§‹åŒ–ä¸€ä¸ªimageView<br>    self.heart = [[UIImageView alloc] initWithFrame:CGRectMake(50, 50, 200, 200)];<br>    self.heart.image = [UIImage imageNamed:@â€4458.jpgâ€];<br>    [self.view addSubview:self.heart];</p>
<p>//å®ä¾‹åŒ–åŠ¨ç”»<br>   CABasicAnimation * animation = [CABasicAnimation animation];</p>
<pre><code>//ç¼©æ”¾åŠ¨ç”»
//è®¾ç½®ç¼©æ”¾å±æ€§
animation.keyPath = @&quot;transform.scale&quot;;
animation.toValue = @0.1;//ç¼©åˆ°0.1
animation.fromValue = @0.5;//ä»0.5å¼€å§‹ç¼©

//è®¾ç½®åŠ¨ç”»çš„å…¶ä»–å±æ€§
//è®¾ç½®åŠ¨ç”»çš„æ‰§è¡Œæ¬¡æ•° MAXFLOAT æ— çº¿å¾ªç¯
animation.repeatCount = MAXFLOAT;
//è®¾ç½®åŠ¨ç”»è‡ªåŠ¨å‘è½¬ï¼Œæ€ä¹ˆå»ï¼Œæ€ä¹ˆå›
animation.autoreverses = YES;
//è®¾ç½®åŠ¨ç”»çš„æ‰§è¡Œæ—¶é•¿
animation.duration = 0.25;
//æ·»åŠ åŠ¨ç”»åˆ°å±‚ä¸Š
[self.heart.layer addAnimation:animation forKey:nil];


    //æ—‹è½¬åŠ¨ç”»
//è®¾ç½®ç¼©æ”¾å±æ€§
animation.keyPath = @&quot;transform.rotation&quot;;
animation.toValue = @(M_PI * 2);
//è®¾ç½®åŠ¨ç”»é‡å¤æ¬¡æ•°
animation.repeatCount = MAXFLOAT;
//è®¾ç½®åŠ¨ç”»æ‰§è¡Œæ—¶é—´
animation.duration = 1;
//æ·»åŠ åŠ¨ç”»åˆ°layer
  //æ·»åŠ åŠ¨ç”»åˆ°å±‚ä¸Š
[self.heart.layer addAnimation:animation forKey:nil];

//å¹³ç§»åŠ¨ç”»
 //keyPathå¯è®¾ç½®ä¸ºxï¼Œyï¼Œzåœ¨å¯¹åº”æ–¹å‘å¹³ç§»æˆ–è€…ç›´æ¥å†™æˆtransform.translationï¼Œåœ¨xå’Œyæ–¹å‘åŒæ—¶å¹³ç§»
 animation.keyPath = @&quot;transform.translation.x&quot;;
animation.fromValue = @(-CGRectGetWidth(self.heart.bounds));
animation.toValue =  @(CGRectGetWidth(self.heart.bounds));
//è®¾ç½®åŠ¨ç”»é‡å¤æ¬¡æ•°
animation.repeatCount = MAXFLOAT;
//è®¾ç½®åŠ¨ç”»æ‰§è¡Œæ—¶é—´
animation.duration = 1;
//æ·»åŠ åŠ¨ç”»åˆ°layer
[self.heart.layer addAnimation:animation forKey:nil];
</code></pre><h2 id="å…³é”®å¸§åŠ¨ç”»CAKeyframeAnimation"><a href="#å…³é”®å¸§åŠ¨ç”»CAKeyframeAnimation" class="headerlink" title="å…³é”®å¸§åŠ¨ç”»CAKeyframeAnimation:"></a>å…³é”®å¸§åŠ¨ç”»CAKeyframeAnimation:</h2><p>æ˜¯CApropertyAnimationçš„å­ç±»ï¼Œè·ŸCABasicAnimationçš„åŒºåˆ«æ˜¯ï¼šCABasicAnimationåªèƒ½ä»ä¸€ä¸ªæ•°å€¼(fromValue)å˜åˆ°å¦ä¸€ä¸ªæ•°å€¼(toValue)ï¼Œè€ŒCAKeyframeAnimationä¼šä½¿ç”¨ä¸€ä¸ªNSArrayä¿å­˜è¿™äº›æ•°å€¼</p>
<ul>
<li><p>å±æ€§è§£æï¼š</p>
</li>
<li><p>valuesï¼šå°±æ˜¯ä¸Šè¿°çš„NSArrayå¯¹è±¡ã€‚é‡Œé¢çš„å…ƒç´ ç§°ä¸ºâ€å…³é”®å¸§â€(keyframe)ã€‚åŠ¨ç”»å¯¹è±¡ä¼šåœ¨æŒ‡å®šçš„æ—¶é—´(duration)å†…ï¼Œä¾æ¬¡æ˜¾ç¤ºvaluesæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…³é”®å¸§</p>
</li>
<li><p>pathï¼šå¯ä»¥è®¾ç½®ä¸€ä¸ªCGPathRef\CGMutablePathRef,è®©å±‚è·Ÿç€è·¯å¾„ç§»åŠ¨ã€‚pathåªå¯¹CALayerçš„anchorPointå’Œpositionèµ·ä½œç”¨ã€‚å¦‚æœä½ è®¾ç½®äº†pathï¼Œé‚£ä¹ˆvalueså°†è¢«å¿½ç•¥</p>
</li>
<li><p>keyTimesï¼šå¯ä»¥ä¸ºå¯¹åº”çš„å…³é”®å¸§æŒ‡å®šå¯¹åº”çš„æ—¶é—´ç‚¹,å…¶å–å€¼èŒƒå›´ä¸º0åˆ°1.0,keyTimesä¸­çš„æ¯ä¸€ä¸ªæ—¶é—´å€¼éƒ½å¯¹åº”valuesä¸­çš„æ¯ä¸€å¸§.å½“keyTimesæ²¡æœ‰è®¾ç½®çš„æ—¶å€™,å„ä¸ªå…³é”®å¸§çš„æ—¶é—´æ˜¯å¹³åˆ†çš„</p>
</li>
<li><p>è¯´æ˜ï¼šCABasicAnimationå¯çœ‹åšæ˜¯æœ€å¤šåªæœ‰2ä¸ªå…³é”®å¸§çš„CAKeyframeAnimation</p>
<p>//å…ˆåˆå§‹åŒ–ä¸€ä¸ªimageView</p>
<pre><code>self.iv = [[UIImageView alloc] initWithFrame:CGRectMake(50, 100, 200, 200)];
</code></pre><p>  [self.view addSubview:self.iv];<br>  self.iv.image = [UIImage imageNamed:@â€4458.jpgâ€];<br>  CAKeyframeAnimation *anim = [CAKeyframeAnimation animation];</p>
<p>   // 1. æŠ–åŠ¨å¹…åº¦</p>
<pre><code>//anim.values = @[@(angle2Rad(-3)),@(angle2Rad(3)),@(angle2Rad(-3))];
</code></pre><p>  // 2. æŠ–åŠ¨å¹…åº¦è¿˜å¯ä»¥ä½¿ç”¨path<br>  anim.path = [UIBezierPath bezierPathWithOvalInRect:CGRectMake(0, 0, 5, 5)].CGPath;<br>  anim.duration = 2;//æŠ–åŠ¨æ—¶é—´<br>  //æŠŠæŠ–åŠ¨æ•ˆæœçš„åŸç‚¹ç”±å›¾ç‰‡çš„ä¸­å¿ƒç‚¹æ”¹æˆ å·¦ä¸Šè§’<br>  self.iv.layer.anchorPoint = CGPointZero;<br>  anim.keyPath = @â€transform.rotationâ€;//æ—‹è½¬                anim.repeatCount = MAXFLOAT;<br>  [self.iv.layer addAnimation:anim forKey:nil];</p>
<p>è¿˜å¯ä»¥æ ¹æ®æ‰‹åŠ¿ç§»åŠ¨ï¼š</p>
<ul>
<li><p>(void)touchesBegan:(NSSet<uitouch *=""> <em>)touches withEvent:(UIEvent </em>)event<br>{<br>UITouch <em>touch = [touches anyObject];<br>// è·å–æ‰‹æŒ‡çš„è§¦æ‘¸ç‚¹<br>CGPoint curP = [touch locationInView:self.iv];<br>// åˆ›å»ºè·¯å¾„<br>UIBezierPath </em>path = [UIBezierPath bezierPath];<br>_path = path;<br>//è®¾ç½®èµ·ç‚¹<br>[path moveToPoint:curP];</uitouch></p>
<p>}</p>
<ul>
<li>(void)touchesMoved:(NSSet<uitouch *=""> <em>)touches withEvent:(UIEvent </em>)event<br>{<br>UITouch *touch = [touches anyObject];</uitouch></li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>//è·å–æ‰‹æŒ‡çš„è§¦æ‘¸ç‚¹
CGPoint curP = [touch locationInView:self.iv];

[_path addLineToPoint:curP];

[self.view setNeedsDisplay];
}

- (void)touchesEnded:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event
{
//ç»™imageView æ·»åŠ æ ¸å¿ƒåŠ¨ç”»
CAKeyframeAnimation *anim = [CAKeyframeAnimation animation];
anim.keyPath = @&quot;position&quot;;

anim.path = _path.CGPath;

anim.duration = 2;

anim.repeatCount = MAXFLOAT;

[self.iv.layer addAnimation:anim forKey:nil];
}

- (void)drawRect:(CGRect)rect
{   //åˆ’çº¿
[_path stroke];
}  ` 
</code></pre><p>å¯¹äº†ï¼Œè¿™æ˜¯å®å®šä¹‰åˆç”³æ˜</p>
<pre><code>#define angle2Rad(angle) ((angle) / 180.0 * M_PI)
@property (nonatomic,strong) UIBezierPath   *path;
@property (nonatomic,strong)UIImageView *iv;
@property (nonatomic,strong)UIImageView *heart;
</code></pre><h2 id="å½¢å˜-CATransform3D"><a href="#å½¢å˜-CATransform3D" class="headerlink" title="å½¢å˜ CATransform3D:"></a>å½¢å˜ CATransform3D:</h2><p>CATransform3Dæ˜¯ä¸€ä¸ªç”¨äºå¤„ç†3Då½¢å˜çš„ç±»,å…¶å¯ä»¥æ”¹å˜æ§ä»¶çš„å¹³ç§»ã€ç¼©æ”¾ã€æ—‹è½¬ã€æ–œäº¤ç­‰,å…¶åæ ‡ç³»ç»Ÿé‡‡ç”¨çš„æ˜¯ä¸‰ç»´åæ ‡ç³»,å³å‘å³ä¸ºxè½´æ­£æ–¹å‘,å‘ä¸‹ä¸ºyè½´æ­£æ–¹å‘,å‚ç›´å±å¹•å‘å¤–ä¸ºzè½´æ­£æ–¹å‘ã€‚åœ¨CALayerä¸­æœ‰ä¸€ä¸ªtransformå±æ€§ä¾¿æ˜¯ä¸“é—¨ç”¨æ¥æ§åˆ¶3Då½¢å˜çš„ï¼Œ</p>
<p> CATransform3D MakeTranslation (CGFloat tx, CGFloat ty, CGFloat tz);<br>    //CATransform3DMakeTranslationå®ç°ä»¥åˆå§‹ä½ç½®ä¸ºåŸºå‡†,åœ¨xè½´æ–¹å‘ä¸Šå¹³ç§»xå•ä½,åœ¨yè½´æ–¹å‘ä¸Šå¹³ç§»yå•ä½,åœ¨zè½´æ–¹å‘ä¸Šå¹³ç§»zå•ä½</p>
<p>####å¹³ç§»åŠ¨ç”»####<br>        [UIView animateWithDuration:0.6 animations:^{<br>            iv.layer.transform = CATransform3DMakeTranslation(100, 100, 0);<br>        }];</p>
<p>####ç¼©æ”¾####<br>        CATransform3D MakeScale (CGFloat sx, CGFloat sy, CGFloat sz);<br>    //CATransform3DMakeScaleå®ç°ä»¥åˆå§‹ä½ç½®ä¸ºåŸºå‡†,åœ¨xè½´æ–¹å‘ä¸Šç¼©æ”¾xå€,åœ¨yè½´æ–¹å‘ä¸Šç¼©æ”¾yå€,åœ¨zè½´æ–¹å‘ä¸Šç¼©æ”¾zå€<br>        [UIView animateWithDuration:0.6 animations:^{<br>        iv.layer.transform = CATransform3DMakeScale(2, 0.5, 1);<br>    }];</p>
<p>####æ—‹è½¬####<br>        CATransform3D MakeRotation (CGFloat angle, CGFloat x, CGFloat y, CGFloat z);<br>    // CATransform3DMakeRotationå®ç°ä»¥åˆå§‹ä½ç½®ä¸ºåŸºå‡†,åœ¨xè½´,yè½´,zè½´æ–¹å‘ä¸Šé€†æ—¶é’ˆæ—‹è½¬angleå¼§åº¦(å¼§åº¦=Ï€/180Ã—è§’åº¦,M_PIå¼§åº¦ä»£è¡¨180è§’åº¦),x,y,zä¸‰ä¸ªå‚æ•°åªåˆ†æ˜¯å¦ä¸º0<br>            [UIView animateWithDuration:0.6 animations:^{<br>        iv.layer.transform = CATransform3DMakeRotation(M_PI*0.25, 0, 0, 1);<br>    }];</p>
<p>####æ¢å¤####<br> transformå±æ€§é»˜è®¤å€¼ä¸ºCATransform3DIdentity,å¯ä»¥åœ¨å½¢å˜ä¹‹åè®¾ç½®è¯¥å€¼ä»¥è¿˜åŸåˆ°æœ€åˆçŠ¶æ€</p>
<pre><code>iv.layer.transform = CATransform3DIdentity;
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">


      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/child/2016/10/31/description/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="hapii">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://tva1.sinaimg.cn/crop.0.14.750.750.180/005PluWajw8fahgdnankoj30ku0lnjsd.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸è¦æ€¥ï¼Œä¸è¦æ€•">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸è¦æ€¥ï¼Œä¸è¦æ€•" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/31/description/" itemprop="url">
                  æœªå‘½å
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-31T12:40:41+08:00">
                2016-10-31
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/10/31/description/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/31/description/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/10/31/description/" class="leancloud_visitors" data-flag-title="">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•° </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <hr>
<p>title: <object returned="" empty="" description=""><br>date: 2015-10-31 12:40:41<br>categories: [æ—¥å¸¸Bug]<br>tags: [nil]</object></p>
<p>å‰å‡ å¤©åœ¨å¼€å‘ä¸­è¦æ ¹æ®idæ¥è¯·æ±‚ä¸€ä¸ªç½‘å€ï¼Œæ‰€ä»¥å°±åŠ äº†ä¸€ä¸ªåˆ¤æ–­</p>
<pre><code>     if (!video.url) {
    video.url = [self getUrlFormId:video.id];
} 
</code></pre><p> ä½†æ˜¯å±…ç„¶ä¸èµ°é‡Œè¾¹çš„æ–¹æ³•ï¼Œpoç»“æœä¸€çœ‹åŸæ¥æ˜¯<br>    <object returned="" empty="" description=""><br>ä¹‹åæ”¹æˆ</object></p>
<pre><code>    if ([video.url isEqualToString:@&quot;&quot;]) {
    video.url = [self getUrlFormId:video.id];
} 
</code></pre><p>å°±å¥½äº†ï¼Œåº”è¯¥æ˜¯å­—å…¸æ¨¡å‹è½¬åŒ–çš„æ—¶å€™ä¸ºäº†å®‰å…¨è‡ªåŠ¨èµ‹å€¼äº†å§ã€‚</p>
<h2 id="å‡ ç§ç©ºçš„åŒºåˆ«"><a href="#å‡ ç§ç©ºçš„åŒºåˆ«" class="headerlink" title="å‡ ç§ç©ºçš„åŒºåˆ«:"></a>å‡ ç§ç©ºçš„åŒºåˆ«:</h2><p>è¿™é‡Œå°±è¦å¿…è¦è¯´ä¸€ä¸‹iOS ä¸­å‡ ç§ç©ºçš„åŒºåˆ«äº†ï¼Œåšå­¦é—®è¦è®¤çœŸå˜›</p>
<p>nilï¼šæŒ‡å‘ocä¸­å¯¹è±¡çš„ç©ºæŒ‡é’ˆ<br>Nilï¼šæŒ‡å‘ocä¸­ç±»çš„ç©ºæŒ‡é’ˆ<br>NULLï¼šæŒ‡å‘å…¶ä»–ç±»å‹çš„ç©ºæŒ‡é’ˆï¼Œå¦‚ä¸€ä¸ªcç±»å‹çš„å†…å­˜æŒ‡é’ˆ<br>NSNullï¼šåœ¨é›†åˆå¯¹è±¡ä¸­ï¼Œè¡¨ç¤ºç©ºå€¼çš„å¯¹è±¡</p>
<p>nilå’ŒNULLä»å­—é¢æ„æ€æ¥ç†è§£æ¯”è¾ƒç®€å•ï¼Œnilæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€ŒNULLæ˜¯ä¸€ä¸ªå€¼ï¼Œæˆ‘çš„ç†è§£ä¸ºnilæ˜¯å°†å¯¹è±¡è®¾ç½®ä¸ºç©ºï¼Œè€ŒNULLæ˜¯å°†åŸºæœ¬ç±»å‹è®¾ç½®ä¸ºç©ºçš„ã€‚è€Œä¸”æˆ‘ä»¬å¯¹äºnilè°ƒç”¨æ–¹æ³•ï¼Œä¸ä¼šäº§ç”Ÿcrashæˆ–è€…æŠ›å‡ºå¼‚å¸¸ã€‚<br>çœ‹ä¸€ä¸‹ç”¨æ³•</p>
<pre><code>NSURL *url = nilï¼›
Class class = Nilï¼›
int *pointerInt = NULLï¼›
nilæ˜¯ä¸€ä¸ªå¯¹è±¡æŒ‡é’ˆä¸ºç©ºï¼ŒNilæ˜¯ä¸€ä¸ªç±»æŒ‡é’ˆä¸ºç©ºï¼ŒNULLæ˜¯åŸºæœ¬æ•°æ®ç±»å‹ä¸ºç©ºã€‚
</code></pre><p>è¿™äº”ä¸ªæ¦‚å¿µå¾ˆå®¹æ˜“æ··æ·†ï¼Œåœ¨ä¸€äº›åœºåˆä¸‹ä»–ä»¬å…·æœ‰åŒæ ·çš„ç”¨æ³•ã€‚é¦–å…ˆè§£é‡Šä¸€ä¸‹â€œç©ºæŒ‡é’ˆâ€æ„æ€ï¼Œç©ºæŒ‡é’ˆæ˜¯æŒ‡è¯¥æŒ‡é’ˆæœªæŒ‡å‘ä¸€å—æœ‰æ„ä¹‰çš„å†…å­˜åŒºã€‚å¦‚int <em>p; int </em>p = NULL;</p>
<pre><code>NSObject *obj1 = [[NSObject alloc] init];
NSObject *obj2 = [NSNull null];    
NSObject *obj3 = [NSObject new];
NSObject *obj4;
NSArray *arr1 = [NSArray arrayWithObjects:obj1, obj2, obj3, obj4, nil];
NSLog(@&quot;arr1 count: %ld&quot;, [arr1 count]); //count: 3 å› ä¸ºobj=nilï¼Œåœ¨åŠ å…¥obj4æ—¶å°±ç»“æŸæ·»åŠ å¯¹è±¡
NSObject *obj1;
NSObject *obj2 = [[NSObject alloc] init];
NSObject *obj3 = [NSNull null];
NSObject *obj4 = [NSObject new];
NSArray *arr2 = [NSArray arrayWithObjects:obj1, obj2, obj3, obj4, nil];
NSLog(@&quot;arr2 count: %ld&quot;, [arr2 count]); //count: 0ï¼Œå› ä¸ºobj1=nilï¼Œæ‰€ä»¥åé¢çš„å¯¹è±¡æ²¡æœ‰æ·»åŠ è¿›å»

[NSNull null]é€šå¸¸ä½œä¸ºå ä½ç¬¦ä½œç”¨ï¼Œå¦‚ä¸‹ï¼š
NSObject *obj1 = [NSNull null];
NSArray *arr1 = [NSArray arrayWithObjects:@&quot;One&quot;, @&quot;TWO&quot;, obj1,@&quot;three&quot;,nil];
for (NSString *str in arr1) {
NSLog(@&quot;array object: %@&quot;, str);
} //resultï¼šOneã€Twoã€ã€three


NSObject *obj1 = [NSNull null]; 
NSArray *arr1 = [NSArray arrayWithObjects:@&quot;One&quot;, @&quot;TWO&quot;, obj1,@&quot;three&quot;,nil];
for (NSString *str in arr1) {
if (str != [NSNull null]){
NSLog(@&quot;array object: %@&quot;, str);
} 
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">


      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/child/2016/10/27/FMDBå­˜å–å­—å…¸/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="hapii">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://tva1.sinaimg.cn/crop.0.14.750.750.180/005PluWajw8fahgdnankoj30ku0lnjsd.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸è¦æ€¥ï¼Œä¸è¦æ€•">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸è¦æ€¥ï¼Œä¸è¦æ€•" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/27/FMDBå­˜å–å­—å…¸/" itemprop="url">
                  FMDBå­˜å–å­—å…¸
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-27T13:24:58+08:00">
                2016-10-27
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2016/10/27/FMDBå­˜å–å­—å…¸/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/27/FMDBå­˜å–å­—å…¸/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/10/27/FMDBå­˜å–å­—å…¸/" class="leancloud_visitors" data-flag-title="FMDBå­˜å–å­—å…¸">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•° </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢:"></a>å†™åœ¨å‰é¢:</h2><p>ios ä¸­å¸¸ç”¨çš„æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼<br>1ã€XMLå±æ€§åˆ—è¡¨ï¼ˆplistï¼‰å½’æ¡£<br>2ã€Preference(åå¥½è®¾ç½®)NSuserDefault<br>3ã€NSKeyedArchiverå½’æ¡£(NSCoding)<br>4ã€SQLite3<br>5ã€Core Data<br>  æˆ‘åœ¨å¼€å‘ä¸­æœ€å¸¸ç”¨çš„å°±æ˜¯2ï¼Œ4äº†ï¼Œ2å¯ä»¥å­˜å‚¨ä¸€äº›å­—ç¬¦ä¸²ä»€ä¹ˆçš„ï¼Œè€Œ4å¯ä»¥å­˜ä¸€äº›ç¨å¤§çš„æ•°æ®ã€‚è™½ç„¶è‹¹æœå®˜æ–¹æ¨èCoreData,å¹¶ä¸”å¥½å¤šäººéƒ½è¯´ä»–å¥½ç”¨,ä½†æ˜¯ç ”ç©¶äº†ä¸€ä¸‹æ„Ÿè§‰åˆä¸æ–¹ä¾¿æœ‰é‡ï¼Œï¼ˆå¯èƒ½æ²¡ç”¨ä¹ æƒ¯å§ï¼‰æ•°æ®å¦‚æœä¸æ˜¯å¤ªå¤šçš„è¯æ²¡æœ‰å¿…è¦ç”¨ï¼Œå†è¯´coreDataä¹Ÿæ˜¯åŸºäºsqlit3ã€‚<br>    ç¬¬ä¸‰æ–¹æ¡†æ¶FMDBï¼Œå®ƒæ˜¯å¯¹libsqlite3æ¡†æ¶çš„å°è£…ï¼Œç”¨èµ·æ¥çš„æ­¥éª¤ä¸SQLiteä½¿ç”¨ç±»ä¼¼ï¼Œå¹¶ä¸”å®ƒå¯¹äºå¤šçº¿ç¨‹çš„å¹¶å‘æ“ä½œè¿›è¡Œäº†å¤„ç†ï¼Œä½¿ç”¨ç®€å•å®‰å…¨.</p>
<h2 id="å­˜å‚¨å­—å…¸"><a href="#å­˜å‚¨å­—å…¸" class="headerlink" title="å­˜å‚¨å­—å…¸:"></a>å­˜å‚¨å­—å…¸:</h2><ul>
<li>(BOOL)executeUpdate:(NSString*)sql, â€¦å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–¹æ³•å­˜å‚¨çš„æ˜¯å­—ç¬¦ä¸²ï¼Œä½†æ˜¯åœ¨å¼€å‘ä¸­å¦‚æœæˆ‘ä»¬éœ€è¦å­˜å‚¨å­—å…¸å’Œå­—ç¬¦ä¸²æ€ä¹ˆåŠï¼Ÿ<br>ä¸¤ç§æ–¹æ³•ï¼š<ul>
<li>(BOOL)executeUpdate:(NSString<em>)sql withParameterDictionary:(NSDictionary </em>)arguments,æœ‰ä¸€ä¸ªè¿™ä¸ªå‡½æ•°ï¼Œä½†æ˜¯æŠ±æ­‰æ•´äº†ä¸¤ä¸ªå°æ—¶æ²¡æ•´å‡ºæ¥ï¼Œä¸¢äººâ€¦æœ‰æ—¶é—´å†è¯´ï¼Œï¼Œå¾…ç»­<br>å¦ä¸€ç§å°±æ¯”è¾ƒç®€å•äº†ï¼ˆä¸€å¼€å§‹çœ‹ä¸ä¸Šè¿™ä¸ªæ–¹æ³•ï¼Œä½†æœ€åè¿˜æ˜¯ç”¨çš„å®ƒï¼‰<br>åœ¨å­˜å‚¨æ—¶è®²å­—å…¸è½¬åŒ–ä¸ºJsonå­—ç¬¦ä¸²ï¼š<br>NSDictionary  <em>dic = vc.jumpBaseInfo;<br>NSError </em>parseError = nil;<br>NSData *jsonData = [NSJSONSerialization dataWithJSONObject:dic options:NSJSONWritingPrettyPrinted error:&amp;parseError];<br>vc.collectionStr =  [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding];</li>
</ul>
</li>
</ul>
<p>ç„¶åå­˜è¿›æ•°æ®åº“ï¼š<br>[_lock lock];<br>NSString *sql = @â€insert into QXNNews (loadUrl,detailID,collectionStr) values (?,?,?)â€;</p>
<p>BOOL isSuccess = [_fmdb executeUpdate:sql,vc.loadUrl,vc.detailID,vc.collectionStr];</p>
<p>[_lock unlock];</p>
<p>åœ¨è¯»å–æ—¶ï¼š<br>//å†å°†jsonå­—ç¬¦ä¸²è½¬åŒ–ä¸ºå­—å…¸ï¼š<br>NSData *jsonData = [vc.collectionStr dataUsingEncoding:NSUTF8StringEncoding];</p>
<p>NSError *err;<br>//å¾—åˆ°å­—å…¸<br>vc.jumpBaseInfo = [NSJSONSerialization JSONObjectWithData:jsonData</p>
<p>options:NSJSONReadingMutableContainers</p>
<p>error:&amp;err];</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“:"></a>æ€»ç»“:</h2><p>æ•°æ®åº“åšå¤§ç²¾æ·±ï¼ŒFMDBå°±æ˜¯å¥½ç”¨ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">


      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://tva1.sinaimg.cn/crop.0.14.750.750.180/005PluWajw8fahgdnankoj30ku0lnjsd.jpg"
               alt="hapii" />
          <p class="site-author-name" itemprop="name">hapii</p>
          <p class="site-description motion-element" itemprop="description">Stay Hungry. Stay Foolish.</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">39</span>
              <span class="site-state-item-name">æ—¥å¿—</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/hapiii" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/5339381110/profile?topnav=1&wvr=6&is_all=1" target="_blank" title="å¾®åš">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  å¾®åš
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.jianshu.com/users/d746cffd2a58/timeline" target="_blank" title="ç®€ä¹¦">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  ç®€ä¹¦
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/oncezhu/activities" target="_blank" title="çŸ¥ä¹">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  çŸ¥ä¹
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hapii</span>
</div>


<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"hapii"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  








  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("zc81aNb6TWWwuKFCHYYHVEwj-gzGzoHsz", "fzUiJKfzp0BdJLPgoyW4Tf5w");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


</body>
</html>
